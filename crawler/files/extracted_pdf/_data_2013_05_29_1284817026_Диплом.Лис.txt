 

 

 

Национальный исследовательский университет 

Высшая школа экономики 

Магистерская программа 

 Факультет экономики 

Магистерская программа 

“Математические методы анализа экономики” 

 

 

МАГИСТЕРСКАЯ ДИССЕРТАЦИЯ 

Метод конечных элементов для оценки деривативов 

 

 

 

 

 

Выполнил: 

Студент группы 71ММАЭ1 
Лис А.И. 

 

Научный руководитель: 

д-р физ.-мат. наук, 

проф. А. С. Шведов. 

Москва 2013 

Содержание 

1.  Введение 

 

 

 

 

 

 

 

 

 

2.  Биномиальная модель оценки опционов   
3.  Метод конечных элементов для решения уравнений в частных 

 

 

 

производных в моделях оценки опционов 

 

4.  Метод радиальных функций для оценки опционов 

 

 

 

 

5.  Методы расщепления оператора для оценки  американских  

3 

8 

14 

22 

опционов 

 

 

 

 

 

 

 

 

 

31 

6.  Расчет стоимости европейского опциона методом конечных 

элементов   

7.  Заключение 

 

 

8.  Список литературы 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

36 

49 

50 

 

2 

 

 

1.  Введение 

Производные ценные бумаги имеют большое значение, как на финансовом 

рынке, так и вне его. Фьючерсы, различные опционы и форвардные 

контракты часто фигурируют в биржевых сделках между финансовыми 

организациями и за пределами биржи. Деривативы используют для 

снижения риска, в качестве объекта инвестиций, для поощрения топ-

менеджмента и для многих других целей. 

На бирже производных ценных бумаг торгуются контракты на условиях, 

заранее определенных биржей. В настоящее время такие биржи 

существуют по всему миру. Основным достоинством биржи является 

полное отсутствие риск неисполнения контракта.  

На внебиржевом рынке торгуются контракты, условия которых не 

регламентированы биржей. Разнообразие таких контрактов на 

внебиржевом рынке гораздо шире, чем на любой бирже. В большинстве 

случаев, стороны просто договариваются об условиях контракта. Ярким 

примером внебиржевой сделки является форвардный контракт – 

договоренность совершить продажу или приобретение какого-либо актива 

в определенный момент времени в будущем. Однако, при заключении 

такого контракта, существует некоторая вероятность, что в момент 

исполнения вторая сторона не выполнит своего обязательства. Такой риск 

существует практически для всех внебиржевых сделок. 

Одним из самых распространенных внебиржевых деривативов является 

своп. Свопом называется контракт, по которому стороны должны 

обмениваться денежными потоками в определенные моменты времени. 

Большую популярность имеют процентные свопы. Когда две компании 

заключают договор процентного свопа, они договариваются об обмене 

денежными потоками, получаемыми от процентного дохода. Ставки 

применяются к одной и той же сумме, но одна компания выплачивает 

 

3 

доход по фиксированной ставке, а другая по плавающей. С помощью 

свопов осуществляется, так называемое, преобразование активов. Если 

компания имеет источник процентного дохода с фиксированной ставкой, 

то она может приобрести своп по которому будет получать платежи, 

зависящие от плавающей ставки процента. Таким образом, компания 

обменяет фиксированный доход на переменный.  

Ценные бумаги с фиксированной доходностью часто становятся базовым 

активом для опционных контрактов. Компания, выпускающая облигацию, 

может оставить за собой право выкупить ее обратно. В таком случае, 

говорят, что в облигацию встроен колл опцион. Встроенный опцион 

обеспечит эмитенту защиту от падения ставки доходности облигации, 

однако, это уменьшит ее начальную рыночную стоимость по сравнению с 

аналогичной облигацией без опциона. Встраивание пут опциона дает 

обратный эффект. В этом случае, облигация становится выгоднее для 

покупателя, однако, как правило, стоит дороже безопционного аналога. 

Одно из самых распространенных направлений использования 

деривативов – хеджирование. Как правило, хеджированием защищают 

себя от рисков, связанных с изменением цен на определенные активы. 

Стратегия хеджирования заключается в приобретении дериватива, цена 

которого зависит от некоторого актива, изменение цены которого может 

негативно сказаться на будущем финансовом результате. Хеджинговые 

позиции делятся на короткие и длинные. При короткой позиции, 

приобретается контракт, доход от которого увеличивается при 

уменьшении цены базового актива. При занятии длинной позиции 

приобретается дериватив, выгода от использования которого выше с 

увеличением цены базового актива. Чаще всего для хеджирования. 

применяются пут и колл опционы. Применение хеджинговой стратегии 

уменьшает риск, однако, вместе с тем, уменьшает и максимальную 

 

4 

прибыль, которую возможно получить в том случае, если риск не 

реализуется.  

Оценка опционов является задачей, имеющей большое прикладное 

значение. В сравнении с другими ценными бумагами на бирже, стоимость 

опциона достаточно сложно определить, даже при наличии необходимой 

информации. Часто, стоимость определенного опциона является для 

инвестора ключевым фактором, при выборе стратегии поведения на рынке. 

Определению справедливой стоимости опционов посвящено большое 

количество книг и научных статей. Прежде чем переходить к 

рассмотрению конкретных задач и способам и их решения, необходимо 

определить понятие опциона, которое будет использоваться в данной 

работе. 

Опцион - ценная бумага, дающая право своему владельцу продать (опцион 

пут) или купить (опцион колл) определенный актив у лица, выпустившего 

данный опцион, в течение определенного времени. Сумму, которая была 

уплачена продавцу контракта, будем считать ценой опциона в начальный 

момент времени. Владелец опциона может продать контракт до даты его 

исполнения третьему лицу и извлечь из этого некоторую прибыль, так как 

цена опциона может значительно измениться даже при небольших 

колебаниях цены актива. 

В данной работе, в основном, будут рассматриваться американские и 

европейские опционы на акции, но аналогичные способы применяются и 

для расчета других видов опционов. Все эти три актива любой участник 

рынка может в любой момент времени купить или продать. Будем 

полагать, в любой момент времени можно продать или купить любое 

количество бумаг. Цена покупки совпадает с ценой продажи. 

Предположим, что участник рынка может купить любую часть ценной 

бумаги. То есть, все ценные бумаги предполагаются бесконечно 

 

5 

делимыми. Ни один из участников рынка не может повлиять на цены 

активов. Однако, процесс изменения каждого актива определяется 

совместными действиями участников рынка. 

Ключевым предположением в теории оценки опционов является 

отсутствие арбитража: ни один портфель не может принести безрисковый 

доход больший, чем портфель из облигаций, приобретенных за ту же цену. 

Решение каждой задачи об оценке опцион можно условно разделить на два 

этапа: построение математической модели для цены опциона, которая 

достаточно точно отражает реальные условия, и решение полученной 

математической задачи. Существует много разнообразных подходов для 

каждого из этих этапов. Для ознакомления, в работе приведен способ 

перехода к математической постановке на примере Биномиальной модели. 

Однако основная часть работы посвящена решению математической 

задачи, построенной с использованием уравнения в частных производных 

Блэка-Шоулза. Существует много способов решения этого уравнения. В 

данной работе акцент сделан на применении метода конечных элементов. 

Данная работа организована нижеописанным образом. В Главе 2 

приводится построение и решение задачи Биномиальной модели для 

оценки опциона. Данная часть приведена для ознакомления. Биномиальная 

модель была выбрана, поскольку является простой для описания, но 

позволяет отразить общую логику рассуждений, которые применяются при 

построении моделей оценки опционов. В Главе 3 проводится обзор статьи 

[7]. В данной статье приводится решение задач оценки опционов со 

сложными краевыми условиями.  В Главе 4 рассмотрена статья [9]. В этой 

статье рассматривается применение метода радиальных функций, схожего 

с методом конечных элементов. В Главе 5 рассмотрена статья [11], где для 

дискретизации математической задачи применяются схемы с 

прямоугольной сеткой. В пятой главе приведена постановка и решение 

 

6 

краевой задачи для европейского опциона пут при заданных входных 

данных.  Были получены следующие результаты: 

  Исследована возможность применения­­ метода конечных элементов 

для оценки производных финансовых инструментов. 

  Проведено сравнение метода конечных элементов с двумя другими 

методам численного решения краевой задачи для безарбитражной 

цены производного финансового инструмента, приведены 

относительные достоинства и недостатки различных методов. 

  Изучена постановка краевого условия, в соответствии с 

экономической сутью рассматриваемого опциона.  

  Метод конечных элементов реализован в виде компьютерной 

программы,­­ численно исследовано изменение безарбитражной 

цены опциона пут в зависимости от волатильности. 

  Изучена скорость сходимости численного решения в методе 

конечных элементов. 

 

 

 

 

 

 

 

 

 

 

 

7 

2.  Биномиальная модель оценки опционов 

2.1. Построение биномиальной модели для оценки опционов 

Пусть St – цена акции в момент времени t.   -цена той же акции в момент 

времени T. Размеры дивидендов, выплачиваемых по акции в моменты 

                    составляют              . В дальнейших 

рассуждениях, мы, в основном будем считать, что дивиденды по акциям не 

выплачиваются. 

Теперь, предположим, что два участника рынка заключили сделку на 

следующих условиях:   

заранее определяется  некоторая сумма K, и если в момент времени T цена 

актива ST будет больше K, то первый участник выплатит второму разницу: 

ST-K. Ясно, что за возможность такой сделки, второй участник должен 

заплатить первому некоторую сумму Ct. 

Сделка такого вида является европейским опционом колл. В начальный 

момент времени второй участник покупает у первого право купить акцию 

S по цене K в момент времени T. Если в этот момент ST превышает K, то 

второй участник может продать ее по цене ST, а затем сразу же купить по 

цене K. При этом чистая доходность будет составлять St-K. 

Аналогичным образом можно определить и опцион пут. Европейский 

опцион пут это договор, дающий владельцу право получить в момент 

времени T сумму K-ST, при условии, что цена ST будет меньше K. Цену 

опциона пут будем обозначать PT. 

P(t,T) – стоимость в момент t облигации, дающей право в момент T 

получить выплату равную единице. 

В нашей модели, будем полагать, что существует функция r(x), такая что 

 (       )      ( (        )). 

 

8 

Для того, чтобы показать преимущества, которые дают вышеописанные 

ценные бумаги, рассмотрим два основных типа портфелей. 

 

В первом случае, инвестор имеет акцию и желает защититься от риска 

резкого падения ее цены. Для этого он приобретает опцион пут ценой 

исполнения K. Тогда доходность такого портфеля в момент времени T 

будет равна: 

                                

При этом, инвестор снижает риск за счет снижения максимального дохода. 

 

Во втором случае, инвестор, наоборот, желает получить дополнительный 

доход. Для этого он продает по цене Ct право купить у него акцию по цене 

K. Доходность портфеля во втором случае будет равна: 

              

  

 (    )

          

  

 (    )

  

За P(t’,t’’) обозначим  цену в момент t’ облигации, которая дает право 

получить в момент t’’ доход, равный 1. При этом справедливо:    

 (       )    , при t’<t’’. 

 

Докажем, что для опционов пут и колл с одинаковым сроком исполнения 

T, ценой исполнения K и стоимостями Pt и St соответственно, выполняется 
следующее соотношение1: 

                    (    )    . 

Доказательство данного утверждения, также, дает представление о 

значении предположения об отсутствии арбитража. 

Положим, что инвестор в момент времени t предпринял следующие 

шаги: 

  Выпустил опцион колл с ценой исполнения K и временем 

исполнения T 

                                                           
1Доказательство данного утверждения можно найти в [2] 

 

9 

  Приобрел опцион колл с теми же характеристиками 

  Выпустил акцию 

  Приобрел K облигаций P(t,T) 

Заметим, что в момент времени T, вне зависимости от цен активов, 

суммарные платежи по такому портфелю будут равны нулю. 

 

 Действительно, пусть в момент времени T K<ST, тогда доходность по 

опциону пут будет равна нулю, а по опциону колл ST-K. Суммарная 

стоимость всех позиций портфеля будет равна нулю. 

Теперь предположим, что ST<K. Тогда стоимость опциона колл будет 

нулевой, а доходность по опциону пут будет равняться K-ST. В этом 

случае, суммарная стоимость также будет равняться нулю. 

Допустим, что стоимость такого портфеля в момент t положительна.  

Тогда, инвестор может продать акцию или опционы, а в момент времени 

T, закрыть все позиции, получив в итоге ненулевую прибыль. 

Если стоимость портфеля меньше нуля, то инвестор сможет получить 

данный портфель без каких либо затрат. А в момент времени T извлечь 

положительную  прибыль. 

И в том, и  в другом случае инвестор получает возможность извлечь 

прибыль из ничего, что является противоречием с предположением об 

отсутствии арбитража. 

Таким образом, утверждение доказано. 

При помощи доказанного соотношения можно определить наличие 

арбитража на рынке. Если цена опциона колл отличается от цены 

опциона пут на величину отличную от           (    ), то это говорит о 

наличии арбитража. 

 

 

 

10 

2.2 Модель поведения цены акции в биномиальное модели 

Прежде чем перейти, непосредственно, к оценке стоимости опционов, 

построим процесс изменения цены акции во времени следующим 

образом: 

S0-известная стоимость акции в начальный момент времени; 

ST-стоимость акции в момент исполнения опциона. 

Разобьем отрезок [0;T] на M>0 равных частей, и для каждого момента 

времени  

                         

 

 

  зададим значение акции, как случайную 

величину. Таким образом, мы получили случайный процесс с 

дискретным временем. Введем предположение, являющееся одним из 

основных в биномиальной модели: в момент времени        цена акции 

не может принимать более    различных значений. Если в момент        

цена акции составила S, то в момент времени      (     ) она может 

составить            или            , где u>d>0. Условие отсутствия 

арбитража может быть записано в следующей форме: 

    

 

(        (     )     )

      

На данный момент мы определили только значения, которые может 

принимать цена акции. Вероятности, с которыми цена будет принимать 

то или иное значение, будут определены позднее, непосредственно при 

оценке стоимости опциона. 

2.3 Оценка опционов с помощью биномиальной модели 

Теперь, когда нам известна цена акции в каждый момент времени, 

мы сможем определить стоимость опциона в нулевой момент 

времени. Располагая ценой опциона в точке       , последовательно 

11 

 

получим значение цены в каждом прошлом моменте времени, и в 

результате, для момента времени 0. 

Проведем рассуждения на примере европейского опциона колл.  

C 

A
А 

B 

 

 

 

 

 

 

 

 

Цена данного опциона в узлах A и  B будет равны: 

        (         )                                                   (          )  

Теперь, попытаемся для узла C, стоимость которого равнялась бы 

либо V’ либо V’’, в зависимости от цены ST. Такой портфель 

называется синтетическим опционом. 

Допустим, наш портфель состоит из δ акций и ν облигаций. Тогда, 

чтобы стоимости синтетического и реального опциона совпали в  

момент времени T, должны выполняться следующие два условия: 

               
{
 
                 

 

Решив данную систему, получим: 

   

      
      ; 

    

           

      

. 

Таким образом, мы получили цену опциона в момент времени T-Δt: 

12 

 

                  (         ). 

Аналогичным методом можно получить значение цены опциона во 

всех узлах, вплоть до нулевого.  

Заметим, что полученная цена опциона не будет зависеть от 

ожидаемой доходности акции. Этот результат обоснован тем, что в 

нашей модели отсутствует арбитраж. В связи с этим, ожидаемая 

доходность любой акции принимается равной доходу безрисковой 

облигации. Исходя из этого условия, можно однозначно определить 

вероятность акции перейти из состояния C в состояние A2: 

   

   (      )     

      

  

Тогда вероятность из состояния C перейти в состояние B равна 1-φ. 

Итак, мы ознакомились с методом оценки опционов с помощью 

биномиальной модели. Этот метод широко распространен из-за своей 

простоты и наглядности. Однако, сложность при вычислении данным 

методом возрастает экспоненциально при увеличении числа активов 

на рынке. Так же, при попытке оценить этим методом более сложные 

форвардные контракты, чем европейский опцион, могут возникнуть 

проблемы.  

 

 

 

 

 

 

                                                           
2 Расчет данных вероятностей приведен в [2] 

 

13 

3.  Метод конечных элементов для решения уравнений в частных 

производных в моделях оценки опционов 

В данном параграфе рассматривается применение метода конечных 

элементов для решения уравнений в частных производных, возникающих в 

моделях оценки опционов.  

Данный метод является развитием работ [4] и [13]. В статье [7], где 

приводится описание применения этого метода, показано, что метод 

конечных элементов подходит для решения задач оценки опционов 

различного характера.  

3.1. Построение модели оценки опционов 

Пусть, стоимость опциона U зависит от двух случайных факторов x1 и x2 

(например, цен на акции или процентных ставок). Зависимость этих 

факторов от времени задается стохастическими дифференциальными 

уравнениями: 

        (          )        (          )     

        (          )        (          )     

где W1 и W2 Винеровские процессы, связанные коэффициентом 

корреляции  . 

Тогда, цена      (           ) будет задаваться уравнением: 

               (  )                    

где r-безрисковая процентная ставка, а           . Перейдем к переменной 

 : 

 

               (  )                

(1) 

14 

Уравнение (1) является двухмерным уравнением конвекции-диффузии с 

тензором диффузии D и вектором скорости потока V с экспоненциальным 

эффектом распада (из-за учета дисконтирования). 

В дополнение, следует потребовать неотрицательности факторов    и   . 

Из этого условия следуют следующие ограничения: 

                              

                              

 

 

(2) 

(3) 

Следовательно, исследуемая область будет ограничена условиями: 

                         

и 

при        или       .  ⃗  – вектор нормали к границе. 

(  )     ⃗          

 

 

(4) 

Так же, необходимо наличие начальных данных при x1=0 или x2=0: 

     ⃗       

В дальнейшем, может понадобиться альтернативная запись уравнения (1): 

     (     (   ) )                                 (5) 

где    - это транспонированный вектор  . Такой вид удобен для 

проведения интегрирования по частям при дискретизации с помощью 

метода конечных элементов. 

3.2. Дискретизация уравнения в частных производных 

Теперь, применим МКЭ (метод конечных элементов) для сведения 

уравнения (1) к дискретному.  

Разобьем область вычисления Ω на треугольники и введем C0 базисные 

функции 

 

15 

Лагранжа, определенные на треугольниках: 

Ni=1 в узле i, 

Ni=0 в других узлах, 

∑        

 

  везде, где определено решение. 

 
Пусть      ∑   
(          ). Тогда, можем записать дискретизированное уравнение (1): 

     (          ) это значение U в точке 

   , где   

 

  

 
        

)   

   (

  

   (∑    (  

   

    

   )   ∑    ⃗⃗⃗⃗⃗ 

    

    

 

     

            
   

   )   

 
 

 
 (     )(∑    (  

    

 )   ∑    ⃗⃗⃗⃗⃗ 

    

 

    

 

     

          
   

 )   

 
 

    

      (     )  

    

 

 

 

(6) 

   -решение в узле i в момент времени n+1, Δt- временной шаг, ϴ 

где   
переменная, определяющая влияние неявной части,    - множество узлов 

соседних с  , а переменные   

    задают граничные условия. 

Для   

                                 3: 

      

  

 

 

  {

                                       ∫  ̂        

∫  ̂        
 
                                                                                                                                   

       
 

 

                                                           
3 Детальные выкладки для получения данного соотношения приведены в работе [7] 

16 

 

 

 

 

 

 

 

e 

f 

Узел i 

g 

Имеет место представление: 

  

     
 
   
 

      

  

   

 

.  

 

 

 

 

 

 

 

(7) 

Тогда, после некоторых преобразований, уравнение (6) можно свести к 

обычной системе линейных алгебраических уравнений, которую можно 

решить, например, методом Ньютона. 

 

3.3. Азиатский опцион 

Для Азиатского опциона конечная выплата зависит от средней цены 

базового актива. Чаще всего Азиатские опционы применяют, когда 

базовым активом является полезное ископаемое. Использование 

усреднения уменьшает чувствительность цены опциона к колебаниям в 

цене актива вблизи момента исполнения. 

 

Предполагается, что цена Азиатского опциона – это функция от цены 

актива  , средней цены    и времени. Пусть, цена акции задается 

следующим процессом: 

а средняя цена актива в любой момент времени задается по следующей 

                      

 

 

 

(8) 

формуле: 

 

17 

   

 
   ∫  ( )   

  

 

   

 

 

(9) 

В (7)   – это ожидаемая доходность актива,    – волатильность, а   -

Винеровский процесс. Основываясь на отсутствии арбитража, можно 

записать следующие уравнения для диффузии и вектора скорости потока: 

   

 
 

     
(  
 
 

)   

и 

      (

  

     
     

)     

оператор градиента определяется формулой 

      (

 
  
 
  

)   

 

 

 

 

 

 

 

(10) 

(11) 

 

(11) 

В момент времени       цена Азиатского опциона справедливо следующее 

равенство: 

 (           )      (        )   

 

 

(12) 

где K – цена исполнения. 

Таким образом, получаются следующие граничные условия: 

 (       )     

 

 

   

 

  

   

  

      

   

(   )

  

(   )

  

      

 

 

 

 

 

 

        

        

  

  

       
  

        

  

  

  

  

  

  

  

  

  

  

 

 

 

 

 

 

 

 

 

 

при                  

при      , 

при             ,   

 

(13) 

  (

 

   

)

  

  

       при A      

  (

   

   

)

  

  

       при A             

В статье приведены результаты расчетов цены Азиатского колл опциона 

для различных значений   и  . 

 

 

18 

3.4. Конвертируемый бонд 

В [7] рассматривается оценка конвертируемых бондов. Для целей 

построения модели, за конвертируемый бонд принимается долговая 

бумага, которая может быть обменяна на некоторое количество акций 

компании в любой момент времени. Также, бонд может быть выкуплен 

эмитентом обратно за фиксированную цену. 

Следующий процесс принят в модели для определения безрисковой 

ставки: 

      (     )               

а данный процесс для цены акции компании: 

                     

где    и    –Виннеровские процессы. 

Аналогично рассмотренным случаям, принимается: 

   

 
 

и 

   

  

(
         

        

     )  
  

      (

 (     )        )     

  

 

 

 

 

 

оператор градиента определяется формулой 

      (

 
  
 
  

)   

 

Условие оплаты в начальный момент времени может быть записано в 

следующем виде: 

 (           )      (     )  

где   – это цена продажи бонда, а   – количество акций, которое может 

быть получено при конвертации. 

 

19 

Возможность конвертации и возможность обратного выкупа бонда могут 

быть записаны следующими уравнениями: 

и 

 (       )      

 (       )       

где   - это цена встроенного колл опциона. Первое условие означает, что 

если цена бонда будет ниже стоимости акицй, которые можно получить 

при конвертации, то произойдет немедленная конвертация. Второе: что 

если доход от опциона будет выше цены колл опциона, то эмитент 

исполнит встроенный опцион. 

Имеют место следующие условия на границу для задачи оценки 

конвертируемого бонда: 

        
  

      ( (     )        )

  

  

       

  

  

  

  

 

 

 

 

 

 

       
  

        

  

  

 

 

 (       )       

 

 

       

 (       )      (      ) 

     . 

 

 

 

 

 

 

 

 

 

 

 

 

 

  

 

 

 

 

 

 

при S      

при r     

при 

при  

В случае, если по бонду предусмотрены купонные выплаты, то к модели 

стоит добавить следующее уравнение: 

 (        )    (        )        

 

 

(14) 

где C – выплата по купону.    и    моменты времени до и после выплаты 

по купону. 

 

3.5. Заключение 

В [7] приведено описание метода конечных элементов к общему 

уравнению в частных производных. В качестве приближения был выбран 
метод Галеркина. 

 

20 

Один и тот же подход был применен к решению разных двухфакторных 

задач, что позволило сделать вывод об универсальности метода. Это 
позволяет использовать его для решения задач, полученных из 
рассматриваемых путем добавления новых ограничений. 

 

 

 

 

21 

4.  Метод радиальных функций для оценки опционов 

В данном параграфе излагается метод, описанный в [9]. Этот метод 

является развитием работ [12] и [8]. Для приближения функций в модели 

оценки опционов предлагается использовать метод разложения по 

радиальному базису. Данный метод походит на Метод Конечных 

Элементов. Однако, здесь в качестве базисных функций приняты 

радиальные функции, которые принадлежат бесконечномерному 

пространству. Большим плюсом радиального базиса является его свойство 

бесконечной непрерывной дифференцируемости. Это позволяет находить 

значения производных от цены Опциона без дополнительных вычислений. 

Применение метода радиальных функций для аппроксимации цены 

Опциона и производных от нее, позволяет представить уравнение Блэка-

Шоулза в виде системы уравнений первого порядка для Опциона. Затем 

эта система может быть решена численно. 

Результаты вычислений показали, что метод радиальных функций дает 

высокую точность в аппроксимации решений по пространственным 

переменным. Для реализации метода не требуется построения сетки, как в 

методе конечных разностей или методе конечных элементов. Область 

вычисления состоит из дискретного множества точек. 

Впервые метод был применен для моделирования географических 

поверхностей. Позднее было показано, что метод удобен для решения 

уравнений в частных производных эллиптического, параболического и 

гиперболического видов. Результат применения метода сильно зависит от, 

предварительно задаваемого, параметра с.  

В [9] можно найти результаты применения метода к уравнению модели 

Блэка-Шоулза для американского и европейского опционов. В качестве 

основного предположения принята риск нейтральность цены базового 

актива. 

 

22 

4.1. Радиальные функции для решения уравнения Блэка-Шоулза 

 

Пусть, значения европейского опциона заданы следующим уравнением 

Блэка-Шоулза: 

 

 

  
  

 

 
 

        

        

  
  

          

 

(1) 

где r –безрисковая процентная ставка, а σ – волатильность цены акции S, 

V(S,t) – цена опциона в момент времени t. Граничный условия заданы 

исходя из условий конечных выплат: 

 (    )   {

                              
 
                               

 

(2) 

где T – момент исполнения опциона, X – страйк. 

 

При замене           уравнение (1) и условие (2) приобретают вид: 

 

  
  

 

 
 

      

      (   

 
 

  )

  
  

           

(3) 

с начальным условием: 

 (    )   {

                               
 
                                

 

(4) 

Метод радиальных функций заключается в интерполяции неизвестной 

функции Uфункциями φследующим образом: 

 

 (    )   ∑   

( ) (|      |)  

 

(5) 

   

где αiнеизвестный коэффициент, зависящий только от времени, а φi(y) = 

φ(|y-yj|)– функции радиального базиса. В качестве таких функций обычно 

использую одну из следующих: 

 

23 

  ( )    

 √(      )                                  (  )
 

    (   (      )

 

)                                              

 

 

(      )

(   (|      |)                                       

 
 
{

где c положительный параметр, в случае MQ его называют параметром 

формы. 

Подставляя (5) в (3), получим следующую систему уравнений первого 

порядка для i=1,…N: 

  (     )

  

 

 
 

      (     )

   

  (   

 
 

  )

  (     )

  

    (     )       

(7) 

Так как функции радиального базиса не зависят от времени, производная U 

по времени может быть представлена в виде: 

  (     )

  

 

  ∑
   

   ( )

  

 (      )  

 

(8) 

Для первой и второй производных по пространственной переменной, 

справедливы следующие соотношения: 

  (     )

  

   (     )

   

 

  ∑   ( )

   

 

  ∑   ( )

   

  (      )
  

  

   (      )
 

   

  (      )

  

 

(     )

√(     )      

   

 

 

 

(9) 

 

(10) 

(11) 

   (      )

   

 

 

√(     )      

(     ) 

 

(     )      

 

 
 

 

(12) 

24 

где 

 

 

Уравнение (7) может быть записано в матричном виде: 

  ̇  

 
 

         (   

 
 

  )               

 

(13) 

гдеα– векторнеизвестныхкоэффициентовαj, аL, Ly, Lyy – 
матрицысэлементамиφ(yi,yj), ∂φ(yi,yj)/∂y, ∂2φ(yi,yj)/∂y2соответственно. 

Уравнение (13) может быть переписано в следующем виде: 

где P – матрица порядка N 

 ̇      

 

 

        (

 
 

         (   

 
 

  )    

Решение уравнения (14) дается следующей формулой: 

 

 ( )   ∑          

 

 

 

 

 

 

 

 

 

(14) 

(15) 

(16) 

где λi и wi– собственные значения и собственные векторы матрицы P. 

Матрица (w1,…,wN) обозначается за W. Так как собственные векторы 

линейно независимы, матрица W обратима. Вектор k может быть 

определен из начального условия: 

где U(T) вектор U(yi,T) значения которого определяются из уравнения (4).  

           ( )  

 

 

(17) 

Для удобства записи, U(yi,T-nΔt) обозначается за Un.В каждый момент 

времени T-nΔt имеют место следующие соотношения: 

Для явного метода обратной разности первого порядка: 

                    

 

 

 

(18) 

Для явного метода второго порядка: 

              

 

25 

         (            ) 

               (       ) 

 

 

 

(19) 

Для явного метода четвертого порядка: 

              

         (            ) 

         (            ) 

         (         ) 

           

                 

 

 

 

Для неявного метода: 

                        (     )    

 

 

 

(20) 

(21) 

 

4.2. Вычисление стоимости европейского опциона 

Для оценки европейского опциона, используются следующие граничные 

условия: 

 (    )       (   )   (    )                                 
{
 (    )       (    )                                               

  (22) 

 

Точное решение уравнения (1) с начальными данными, заданными (2) и 

граничными условиями (22) дается следующими формулами: 

 

 

    

    

    (

 
 )   (   

 
 

  )(     )
 

 √     

    (

 
 )   (   

 
 

  )(     )
 

 √     

 

 

 

 

(24) 

(25) 

26 

 

Пусть S [Smin,Smax], следовательно, u [log(Smin), log(Smax)]. В вычислениях, 

приведенных в статье, Smin=1, Smax=30. Пусть Δy= log(Smax)/(N-1) и yj=(j-

1)Δyдля j=1,2,…,N. Из значений yjнемедленно определются матрицы L, 
LyиLyy. Затем, могут быть найдены матрицы L-1иP. Вектор U0определяется 

из условия (4) следующим образом: 

                      

 

 

 

(26) 

 

Значение α0 определяется соотношением α0=L-1U0.Остальные значения 

вектора α получаются непосредственным применением одного из 

алгоритмов, описанных в (16), (17), (18), (19), (20) и (21). 

Временной отрезок разбивается на M интервалов. Тогда, Δt=T/M. 

Независимо от выбранного алгоритма, на каждом шаге n=1,…,M. Нужно 

произвести расчет αnв соответствии с граничным условием. Для 

европейского пут опциона, эта процедура описывается следующими 

шагами: 

1.  Рассчитать          

2.  Принять   ( )           

3.  Для расчета    вычислить       

Для неявного алгоритма,    рассчитывается по формуле: 

       

          

 

 

(27) 

где 

  

 

 

 

 

          (     )     

          (     )    . 

 

27 

Для явных методов актуальна проблема устойчивости решения. Поэтому, 

дополнительно рассматривается применение неявных схем вычисления. 

 

4.3. Вычисление стоимости американского опциона 

Известно, что задача оценки стоимости американского опциона является 

задачей с открытой границей. американский опцион может быть исполнен 

в любой момент времени            когда акция принимает оптимально 

значение      ( ). Проблема большинства существующих методов 

состоит в том, что вид границы  ( ) неизвестен. Возможность раннего 

исполнения американского опциона отражается следующим 

соотношением: 

 (    )         (    )   (    )   

 

 

(28) 

где значение итоговой выплаты  (    ) определяется уравнением (2) как 

для колл так и для пут опциона.  

Процедура оценки американского опциона похожа на процедуру оценки 

европейского. Расчет αn для американского пут опциона производится по 

следующему алгоритму: 

1.  Рассчитать          

2.  Для i=1,2,…,N принять   ( )                   ( )  

3.  Для расчета    вычислить       

Так как функции радиального базиса бесконечно дифференцируемы, 

производные от цены опциона можно получить без дополнительных 

вычислений. Для иллюстрации, в следующей таблице приведено сравнение 

точности вычисления значения Дельты 

  (   )

  

 американского пут опциона. 

В большинстве случаев, найти оптимальное граничное условие  ( )для 

оценки американского опциона-сложная задача. Из условий (2) и (28), 

28 

 

оптимальное граничное условие должно удовлетворять следующему 

соотношению: 

или 

 ( ( )   )        ( )  

 ( ( )   )        ( )  

 

 

 

 

 

 

(29) 

(30) 

где  ( )     ( ). В каждый момент времени n, приближенное значение 

 
границы  (       )      

 может быть рассчитано итеративным методом. 

Для нахождения нуля   

  функции  ( )    (          )        . По 

методу Ньютона, решение может быть представлено как: 

      
  

     

 (  
  (  

   )
  
   )

 

 

 

(31) 

где значения функции F и ее производной    могут быть посчитаны 

Методом Радиальных Функций, используя для аппроксимации U формулу 

(5). На каждом шаге n, за начальное приближение   

  принимается 

значение     

 

, полученное на предыдущем шаге. 

В рассматриваемой статье приводится пример расчета оптимальной 

границы  ( ). В качестве схемы для апрроксимации по времени выбран 

метод обратной разности первого порядка. Ниже приведен график 

функции  ( ), рассчитанный в условиях примера 4.. 

4.4.  Заключение 

Результаты, приведенные в статье показывают, что Функции с Радиальным 

Базисом позволяют получить оценки с высокой точностью, как для 

европейского, так и для американского опционов. Также, метод 

радиальных функций позволяет получать оценки для производных от 

значений опционов, таких как Дельта опциона без каких-либо 

дополнительных вычислений. 

 

29 

Из материалов статьи, можно сделать вывод, что рассматриваемый метод 

имеет достаточно высокий порядок точности интерполяции. Однако в 

статье приводились только результаты решения уравнения с 

экспоненциальной заменой. Оценить точность аппроксимации решения, в 

общем случае, авторам статьи не удалось. Пока таких оценок не получено, 

метод радиальных функций нельзя рассматривать как полноценную 

альтернативу методу конечных элементов или методу конечных разностей. 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

30 

5.  Методы расщепления оператора для оценки американских 

опционов 

В этом параграфе для решения задачи об оценке стоимости американского 

опциона используется метод, описанный в работе [6] и далее развитый в 

[11]. Как известно, американский опцион дает право купить (колл опцион) 

или продать (пут опцион) определенный актив по фиксированной цене. 

Продавец опциона обязуется продать или купить базовый актив, в момент, 

когда покупатель опциона решит его исполнить. Американский опцион 

может быть исполнен в любой момент до истечения его срока. Поэтому, 

американский опцион считается более гибким инструментом. 

Для европейских опционов существуют аналитические формулы, 

позволяющие посчитать их стоимость. Для американских опционов 

возникает проблема открытой границы, связанная с тем, что опцион может 

быть исполнен до срока истечения. В [11] описано использование методов, 

основанных на дискретизации уравнения Блэка-Шоулза, для оценки 

американского опциона. Для дискретизации пространства используются 

конечные разности. 

Для дискретизации уравнения Блэка-Шоулза достаточно часто 

используется равновесная схема. Эта схема имеет точность второго 

порядка, однако, обладает низкой устойчивостью. Двухшаговый метод 

обратного дифференцирования (BDF) также имеет второй порядок 

точности, но обладает лучшей устойчивостью. В [11] можно найти данные 

результатов применения обоих методов. 

В результате дискретизации по времени, получается задача, не являющаяся 

задачей линейного программирования. Для перехода к задачам линейного 

программирования, в статье предлагаются методы, основанные на 

расщеплении оператора. Идея метода состоит в том, чтобы разложить 

оператор в уравнении Блэка-Шоулза и оператор в граничном условии. 

 

31 

Расщепление позволяет перейти к решению линейных подзадач на каждом 

шаге. Решить эти подзадачи гораздо проще, чем исходную задачу. 

Численные результаты, приведенные в статье, показывают, что точность 

решения от такого перехода меняется незначительно. 

5.1. Построение модели для американского опциона 

Американский пут опцион дает право продать базовый актив в любой 

момент времени до истечения срока действия опциона. 

В статье введены обозначения: 

E – цена исполнения; 

T – дата истечения срока опциона; 

r – безрисковая процентная ставка; 

 - волатильность актива; 

v - цена опциона, которая может быть рассчитана решением следующей 

задачи: 

 

   

  

  

 

 

 

        

        

  

  

      

                   , 

     (     )           

 

                   , 

    (     )              

                   ,  

 

(1) 

       (        )   

       

       

 

  

 

 

 

 

 

 

              , 

                             , 

 

                    , 

где t – время, а x – стоимость базового актива. Вспомогательная 

переменная λ введена, чтобы цена опциона была больше, чем E –x. 

32 

 

Для определения конечной области решения задачи, интервал (    ) 

урезан до (     ). Граничное условие при x=cE принимается      . Авторы 

полагают, что ошибка, образовавшаяся в результате такого усечения, будет 

пренебрежимо малой. 

5.2. Пространственная дискретизация 

Для пространственной дискретизации, в статье используется сетка на 

интервале (     ) с n+1 узлом. Размер шага принимается равным   . 

Значение v в узле          обозначается через                   Используя 

конечную разность, можно получить формулу: 

 
 

        

     

 

 (  )      

 (                 )    

 (2) 

и 

 

  

  

  

 

 

   

   (           ).   

 

 

 (3) 

Заменой          из (2) и (3) получаются следующее соотношение: 

        

 

 

  )    ) 

        
(4) 

  

  

      

 

 

(         )       (        )    

(      

 

 

За A обозначена матрица, полученная из разностной схемы (4). 

Можно записать (1) в форме: 

  

  

                

           .    

 

 

(5) 

5.3. Временная дискретизация 

Для временной дискретизации используется сетка с шагом   . Решение v в 

момент         обозначается за   . Также, вспомогательная переменная λ 

 

33 

в момент         обозначается за   . Значения в узлах t=T определяются 

из условия   

( )      (         ), где         . 

Схема вычисления цены американского опциона, где значения    и 

  вычисляются из даются  (   ) следующей формулой: 

 
  

( (   )    ( ))     ((     ) (   )     ( ))    ( )      

   (6) 

[  

( )   (      )]     

( )      

 

( )             

   

( )                        

Параметр   выбирается из отрезка [0,1]. В зависимости от выбора   

меняется тип схемы. Например: при       – неявная схема, при       – 

явная схема, при         – равновесная схема. Из всех возможных 

вариантов только равновесная схема обладает вторым порядком точности. 

Формула метода BDF для оценки американского опциона, где    и 

  вычисляются из даются  (   ) и  (   ) выглядит следующим образом: 

 
  

(

 
 

 (   )    ( )  

 
 

 (   ))  

 
 

(  ( )    ( ))      

(7) 

[  

( )   (      )]     

( )      

 

( )             

   

( )                        

Как  и  для  любой  двухшаговой  схемы,  первый  шаг  должен  делаться  с 

помощью 

какой-либо 

одношаговой 

схемы.  Авторы  предлагают 

использовать  неявную  схему,  что  приведет  к  понижению  точности 

решения. Однако, точность второго порядка все-же будет достигнута. 

Задачи (6) и (7) не являются задачами линейного программирования. 

 

 

34 

5.4. Расщепление оператора 

Основная идея метода разделения оператора состоит в том, чтобы на 

одном шаге решать уравнение Блэка-Шоулза, а на другом, задачу, 

задаваемую ограничением   

( )         . Для дискретизаций (6) и (7), 

первые шаги могут быть записаны в виде: 

( (   )    ̃( ))     ((     ) (   )     ̃ ( ))    (   )      

(8) 

 
  

и 

 
  

(

 
 

 (   )    ̃( )  

 
 

 (   ))  

 
 

(  ̃ ( )    (   ))       

(9) 

Промежуточный вектор  ̃ ( ) может быть получен из решения (8) и (9). 

Когда получено значение промежуточного вектора, может быть решена 

задача, задаваемая ограничением. Для (8) и (9) задачи на втором шаге 

выглядят следующим образом: 

( ̃( )    ( ))    (   )    ( )       

 

 

(10) 

[  

( )   (      )]     

 

( )             

   

( )                        

 
  
( )      

и 

 
  
( )      
( )   (      )]     

[  

 

 
 
( )             

   

( ̃( )    ( ))  

( (   )    ( ))         

 

(11) 

( )                        

Значения   

( )

( )

и   

могут быть получены из (10) и (11) достаточно просто, 

так как не зависят от других компонент. 

5.5. Проведение вычислений 

В  статье  приведены  расчеты  для  американского  пут  опциона  со 

следующими параметрами: волатильность  =0.4, цена исполнения  E=10.0, 

35 

 

длительность  действия  опциона  T=0.5.  В  рассматриваемом  примере 

областью  вычисления (     )          является  область (    )          .  В 

работе  приведены  результаты  для  всех  дискретизаций,  обозначенных 

выше.  Размеры  шагов  по  времени  m,  и  по  пространству  n  выбраны  так, 

чтобы  точность  была  достигнута  высокая  точность  при  сравнительно 

небольшом количестве mn – узлов сетки. 

5.6. Результаты вычислений 

В статье даны результаты вычислений для задачи, сформулированной 

выше. Для всех выбраных m и n указана максимальная ошибка (error) и 

время вычисления (CPU). 

Для сравнения с методом разделения оператора в статье приведены 

результаты решения аналогичной задачи, используя метод полной 

релаксации. Метод полной релаксации был выбран для сравнения, так как 

его часто используют для решения задач типа (6) и (7). 

Как и ожидалось, обе схемы дают одинаковый порядок ошибки. При этом, 

BDF схема выполняется несколько быстрее. 

5.7. Заключение 

Исходя из результатов расчетов, проведенных в статье, метода разделения 

оператора позволяет получить решение такого же порядка точности, как и 

метод  полной  релаксации,  но  время  вычислений  для  метода  разделения 

оператора  будет  гораздо  меньше.  Однако,  такой  вывод  делать  не  совсем 

корректно,  так  как  метод  полной  релаксации  зависит  от  задаваемого 

параметра. С другой стороны, тот факт, что метод разделения оператора не 

зависит от параметра, делает его проще для применения. 

 

 

 

36 

6.  Расчет стоимости европейского опциона методом конечных 

элементов 

Оценка опциона – одна из самых нестандартных и технически сложных 

задач, с которыми сталкиваются специалисты в области финансов. 

Обычно, справедливая стоимость опциона определяется с целью 

извлечения прибыли от его покупки или продажи. Это обстоятельство 

указывает на наличие арбитража на финансовых рынках. Арбитражем 

называется возможность получения гарантированной ненулевой прибыли 

большей, чем позволяет вложение денег под безрисковый банковский 

процент. Однако в математических моделях расчета цены опциона одним 

из базовых условий является отсутствие арбитража. Поэтому, для точной 

оценки необходимо правильно выбрать математическую модель и точно 

задать все входные условия. Но в данной работе акцент делается на 

решении задачи, когда нет дополнительных условий, и отсутствует 

арбитраж. 

Для моделирования поведения стоимости опциона широко используется 

модель Блэка-Шоулза. С помощью этой модели можно получить 

уравнение в частных производных, решением которого будет являться 

функция, отражающая цену опциона в любой момент времени           В 

данной работе рассматривается постановка краевых условий и решение 

данного уравнения методом конечных элементов.  

6.1. Метод Конечных Элементов 

Метод конечных элементов (МКЭ) был изобретен инженерами в 1950 году 

для решения уравнений в частных производных, возникающих при 

решении задач механики сплошных сред. МКЭ заключается в 

представлении решения с помощью базиса кусочно-полиномиальных 

финитных базисных функций с локальными носителями. 

 

37 

Реализация МКЭ – это не столько решение систем линейных уравнений, 

сколько их построение. Процесс решения задачи сводится к разбиению 

расчетной области на непересекающиеся подобласти, на которых строятся 

локальные матрицы жесткости и векторы нагрузок. Затем, происходит 

ассамблирование – получение глобальной матрицы жесткости и вектора 

правой части. Реализация этой схемы допускает разнообразие, за счет 

большого количества способов разбиения области и использования 

различных типов полиномов. 

МКЭ привлекает вычислителей-математиков из-за стройной 

математической теории, лежащей в его основе. Строго говоря, МКЭ 

заключается в поиске решений краевых задач на последовательности 

конечномерных подпространств Соболева. Иначе говоря, МКЭ – это поиск 

последовательности ортогональных, относительно скалярного 

произведения в энергетическом пространстве, проекций функций из этого 

пространства на последовательность конечномерных пространств. Обычно 

энергетическое пространство является пространством Соболева или его 

замкнутым подпространством. Поэтому, вопрос о сходимости 

последовательности приближенных решений к точному сводится к 

вопросу об аппроксимации пространств Соболева последовательностью 

конечномерных подпространств.  

В финансах, МКЭ используется для дискретизации уравнений в частных 

производных, которые, в том числе, возникают при оценке опционов. При 

этом, МКЭ используется для дискретизации пространственной части 

уравнения, а для временной части используют разностную схему. 

По сравнению, например, с методом конечных разностей, МКЭ труднее в 

реализации, однако, позволяет адаптировать сетку для решения 

нетривиальных краевых задач, которые часто возникают при оценке 

опционов. Кроме того,  для МКЭ существует достаточно общая теория 

сходимости, что значительно упрощает исследование на сходимость. 

38 

 

Теперь, опишем схему МКЭ более подробно. 

Пусть H – гильбертово пространство, А – линейный оператор с областью 

определения       . 

Рассмотрим следующие задачи: 

Задача А. По заданному элементу       найти элемент        такой, что 

имеет место равенство 

      . 

Пусть для оператора A построено энергетическое пространство    со 
скалярным произведением  (    ) и нормой ‖ ‖ ,       – некоторый 

элемент основного пространства и        – произвольный элемент из 

энергетического пространства. 

Задача B. По заданному элементу       найти элемент        такой, что 

имеет место равенство: 

 (    )   (    )  

Задачи такого вида называют Проекционными. 

Вопрос об однозначной разрешимости задачи B дает известная теорема. 

Теорема 1. 

Пусть H – гильбертово пространство скалярным произведением 〈      〉, и 

нормой‖  ‖; 

 (      )- билинейная форма, такая что: 

           (    )          | (    )|    ‖ ‖‖ ‖ 

                   (    )    ‖ ‖  

  является непрерывной линейной формой в  . 

 

39 

Тогда, решение задачи B существует и единственно. 

Теорема 2. 

Пусть        – решение задачи B и, кроме того, пусть       . Тогда и 

является решением задачи A. И обратно, пусть существует решение задачи 

А, Тогда оно является и решением задачи B. 

Доказательство обеих теорем приведено в [3]. 

6.2. Задача оценки европейского пут опциона 

Рассмотрим европейский пут опцион со страйком K и моментом 

исполнения T. Цена базового актива описывается процессом: 

        (          )  

где    – Виннеровский процесс. 

Наряду с базовым активом, определим цену безрискового актива, в роли 

которого выступает бескупонная облигация, дающая право получить 1 

дохода в момент времени T. 

В данной статье, для простоты, будем считать, что цена такой облигации в 

момент t описывается уравнением: 

        (   )  

где r – фиксированная процентная ставка. 

В момент исполнения T, в случае, если цена актива будет меньше K, 

держатель опциона сможет использовать его, продав актив за K и купить 

акцию на рынке за   ; если цена актива будет выше K, то исполнять 

опцион не будет иметь смысла. Поэтому, из отсутствия арбитража следует, 

что в момент времени T, цена опциона должна равняться (     ) : 

(     )    {

                    
                        

  

40 

 

Будем считать, что при увеличении цены актива, стоимость опциона будет 

стремиться к нулю, так как при очень большой цене актива выгода от 

использования пут опциона крайне сомнительна. 

 (    )                 

На практике, для упрощения вычислений, полагается, что существует 

значение актива L настолько большое, что в случае достижения активом 

этого значения, стоимость пут опциона становится равной нулю. Таким 

образом, вместо условия записанного выше, будем использовать 

следующее: 

 (    )      

При нулевой цене актива, из условия отсутствия арбитража следует: 

 (    )       (   )  

Известно, что уравнение для определения цены такого опциона задается 

 (           )  имеет вид: 

     

    

 

                                             

С этого момента, переобозначим T-t как t, для удобства записи. 

6.3. Дискретизация задачи 

Исходную задачу можно представить, как поиск функции u, 

определенной на временном отрезке [0;T] и принадлежащей 

гильбертовому пространству V, такой что: 

 
  

где 

 

(    )     (    )     

            (    )   (    )   (     )   

    {      (  )   

  
  

    (  )}  

41 

Найдем явный вид   (    ).  

Скалярное произведение на пространстве  задается следующей 

формулой: 

Поэтому, 

 

(    )   ∫  ( ) ( )   

 

 

 

  (    )   ∫( 

 

    

 

    ( )       ( )     ( )) ( )   

 

Применим формулу интегрирования по частям к первому слагаемому: 

 

∫  

 

    

 

   

    

 

 

    ( ) ( )  

  

   ( ) ( )|

 
 

 

  ∫

 

    

 

  ∫       ( ) ( )  

  

   ( )   ( )    
 

 

Таким образом: 

  (    )   (

    

 

        )   (     (      ) )   (     )  

Для того, чтобы записать Проекционную постановку задачи нужно 

построить конечномерное пространство   , аппроксимируещее 

пространство  . 

Пусть {  }    

   – базис     Для построения пространства    в данной 

работе используются линейные функции, которые позже будут 

определены явно.  

Теперь, задачу (2) можно представить в следующем виде: 

Найти функцию    определенную на отрезке       , принадлежащую 

пространству        такую что: 

 

42 

 
  

(      )     (      )       

 

 

 

Эту задачу можно записать в виде системы дифференциальных 

уравнений: 

 
  

(        )     (        )                   

или в матричном виде: 

 

  
  

   ( )                 (      )          (      )  

Теперь, применим к (7) неявную схему Эйлера с шагом по временной 

координате: 

  

 

         

   

                

где         (  )  
Вернемся к вопросу задания базиса пространства   .  

            ( )    ( )        ( )   где   ( ) – финитные линейные 

функции. 

Пусть    

 

   

,                             . 

  ( )  

 ,  k=2,…,N+1 

 
 

 
 
{

                                      
        
                   

 

        

 

                
                                      

Определим базисную функцию, соответствующее узлу   . Для того, чтобы 

построить решение, удовлетворяющее краевому условию  (    )  

    (   ), функция должна иметь вид: 

      

 

 

       
                            

  ( )   {

 

  

43 

Для краевого условия  (    )     не требуется строить специальную 

функцию.  

Полученные функции базиса имеют следующий вид: 

1 

0 

h 

2h 

 

L 

Теперь подсчитаем матрицы   и     . Заметим, что (      ) и   (      ) 

равны нулю для несмежных базисных функций.  

 

  

(      )   ∫   ( )

  ( )     ∫   ( )

 
  ( )     ∫

(     ) 

    

 
 

  

 

 

 
  ( )     ∫

 

(     )

 

 

(      )

 

    

  

 
 

  

  
  ( )     ∫

(        ) 

  

    

     ∫

  

(        ) 

  

     

 

    

 

 

(      )   ∫   ( )

 

 

(      )   ∫   ( )

  

 

(        )   ∫   ( )

 

 

(     (     )) 

  

  ∫

 (   )

 (   )

     ∫

  

( (     )    ) 

  

    

  
 

  

    
    ( )     ∫

  

        

 

 

      

 

    

 
 

  

(          )   ∫   ( )

 
  ( )     ∫

 (   )

 (   )

 

(     ) 

  

    

 
 

  

44 

Таким образом, матрица B имеет следующий вид: 

   

 
 
 
 

 

 
 
 
 
 
 

(

 

 
 
 
 

 
 
  
 
 
 
 

 

   

 

 

 
 
 
 
 
 

 

 
 
 )

Аналогичным образом подсчитаем     . 

  (    )   (

    

 

        )   (     (      ) )   (     ) 

 
  (      )   ∫(

 

    

 

    ( )    ( )       ( )((      ))  ( )

     ( )  ( ))     

 

  ∫(

 

    

 

 
    

 
 

(      )

     

 

   

(     ) 

  

)     (

 
 

   ) (   

  
 

)  

 
  (      )   ∫(

 

    

 

    ( )    ( )       ( )(      )  ( )

      ( )  ( ))     

 

  ∫( 

 

    

 

 
    

 
 

(      )

(      )

 

   

(     )

(      )

 

 

)  

  (

 
 

   ) (

 
 

 

  
 

)  

  (        )   

 

45 

 (   )

  ∫ (

  

    

 

    ( )      ( )

      ( )(      )    ( )   

 (   )

    ( )  ( ))     ∫ ( 

  

    

 

 
    

 
 

(      )

(      )

 

 
 

(     (     ))

(      )

 

 

)     (

 
 

   ) (

 
 

 

  
 

)  

 

 

 (   )

  (      )   ∫ (

 (   )

    

 

  (  ( )) )     

    ( )    ( )

      ( )(      )  ( )   

  

    

 

 
    

 
 

(      )

      

 

   

(

      

 

 

)

     

  ∫ (

 (   )

 (   )

  ∫ (

  

    

 

 
    

 
 

(      )

(      )

 

   

(

(      )

 

)      

    (

 
 

   ) (

 
 

 

  
 

)  

Таким образом, матрица      будет иметь один и тот же вид на каждом 

шаге по временной сетке: 

         

     
     
     

 
 

 
 

(

 

   

 
 

   
   )

 ,    

 
√(

 

 
√(

 

 
 

(

 
   ) (
 
 

 

 
   ) (
 

 

  
 

  
 

)
 
 
)
)

  

46 

Пространство   обычно называют пространством кусочно-линейных 
функций, базис   - узловым, а представление функции в базисе   : 

   

 ( )   ∑  (

  )  ( ) - сеточной функцией. 

   

Сеточную функцию, аппроксимирующую  ( ) по заданным узлам сетки 

называют кусочно-линейным интерполянтом и обозначают    ( ). 

Прежде чем проводить вычисления, нужно определить, насколько близка 

функция к своему кусочно-линейному интерполянту. 

Ответ на этот вопрос зависит от того, в какой норме оценивать 
погрешность. Для оценки нормы отклонения в пространствах    и    

существует теорема, доказанная в рамках теории МКЭ. Доказательство 

приведено в [1]. 

Теорема 3. 

Пусть       , тогда имеют место неравенства: 

 

‖       ‖       | |    

‖       ‖      (     )| |    

6.4. Результаты расчетов 

Описанный метод продемонстрируем на расчете стоимости европейского 

пут опциона. 

Аналитическое решение задачи (1) при краевых условиях  (    )     и 

 (    )       (   )известно и задается формулой: 

 (    )           ((   ) (   )        (   )  

где 

 

47 

   (

 
 )   (   
 √ 

  
  )  

    

             √   

 

 ( )   ∫  ( )      

 ( )  

  

 

√  

    ( 

  
 

)  

Используя это решение можно протестировать решение, полученное 

методом конечных элементов. 

Таблица 1. Таблица расчетов для опциона с       ,         ,        , 

       . Шаг по времени при расчетах был взят за 0,01. 

Цена  Ошибка 

1,092 

0,036 

1,105 

0,023 

1,120 

0,009 

N 

10 

20 

30 

 

Таблица 2. Таблица расчетов для опциона с       ,         ,        , 

        . Шаг по времени при расчетах был взят за 0,01. 

N 

10 

20 

30 

Цена  Ошибка 

0,032 

0,009 

0,036 

0,005 

0,039 

0,003 

В расчетах L принималось за 200. 

Из результатов расчетов, можно заметить уменьшение ошибки с 

увеличением размерности пространства   . Это является следствием 

сходимости, следующей из Теоремы 3. 

Кроме того, можно заметить, что, при прочих равных, цена опциона 

меньше при меньшей волатильности базового актива. 

 

48 

7.  Заключение 

В данной работе была детально показана дискретизация уравнения в 

частных производных для нахождения цены опциона методом конечных 

элементов и проведены расчеты. 

Сходимость метода, доказанная в [1] аналитически, была подтверждена 

численными расчетами. 

Была исследована зависимость цены опциона от волатильности базового 

актива. 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

49 

 

8.  Список литературы 

1.  Лаевский Ю.М., Метод конечных элементов, Новосибирский 

Государственный Университет, 1999. 
 

2.  Шведов А.С., О математических методах, используемых при работе с 

опционами, Экономический журнал ВШЭ, №3, стр. 385-410, 1998. 
 

3.  Шведов А.С., Процентные финансовые инструменты: оценка и 

хэджирование, Издательский дом ГУ-ВШЭ, 2001.  
 

4.  Brennan M.J., Schwartz E.S., Convertible Bonds: Valuation and Optimal 
Strategies for Call and Conversion, Journal of Finance, vol. 32, pp. 1699-
1715, 1977. 
 

5.  Broadie M., Detemple J. B., Option pricing: Valuation models and 

applications, Management science, vol. 50, pp. 1145-1177. 
 

6.  Cryer C.W., The solution of a quadratic programming problem, using 
systematic overrelaxation, SIAM J Control, vol. 9, pp. 385-392, 1971. 
 

7.  Forsyth, P. A., Vetzal, K. R., Zvan, R., A General Finite Element 
Approach for PDE Option Pricing Models, Preprint University of 
Waterloo, Version December 1998. 
 

8.  Grant D., Vora G., Weeks D., Simulation and the Early-Exercise Option 
Problem, Journal of Engineering Analysis with Boundary Elements, vol. 
18, p. 211, 1996. 
 

9.  Hon Y.C., Mao X.Z., A radial basis function method for solving options 

pricing models, Journal of Financial Engineering, pp. 1-22, 1999. 
 

10. Hull J., Options, Futers, and other Derivative Securities, Journal of 

Banking & Finance, vol. 19, pp. 299-322, 1993. 
 

11. Ikonen S.; Toivanen J., Operator splitting methods for American option 

pricing, applied mathematics letters, Volume 17, pp. 809–814, 2004. 
 

12. Wu Z., Compactly Supported Positive Definite Radial Functions, Journal 

of Advances in Computational Mathematics, vol. 4, p. 283, 1995. 
 

13. Zienkiewicz O.C. The Finite Element Method, McGraw Hill Limited, 

Toronto, 1977. 
 

 

50 

14. Zvan R., Forsyth P.A., Vetzal K.R., Robust numerical Methods for PDE 
Models of Asian options, The Journal of Computational Finance, vol. 1, 
pp. 39–78, 1993. 
 

15. Zvan R.,Forsyth P.A., Vetzal K.R., PDE Methods for Pricing Barrier 

Options, Journal of Economic Dynamics and Control, 2000. 

 

 

 

 

 

51 

