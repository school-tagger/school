Правительство Российской Федерации

Федеральное государственное автономное образовательное учреждение высшего профессионального образования 

«Национальный исследовательский университет 

«Высшая школа экономики»



Факультет Бизнес-информатики

Отделение Прикладной математики и информатики

Кафедра Анализа данных и искусственного интеллекта





ВЫПУСКНАЯ КВАЛИФИКАЦИОННАЯ РАБОТА БАКАЛАВРА

на тему  

Решение нелинейного дифференциального уравнения Фоккера – Планка.







Выполнил: студент группы № 471

Бобровский Дмитрий Игоревич



Научный руководитель: 

д.э.н., профессор Евстигнеев Владимир Рубенович

















Москва 2014

Содержание



Введение …………………………………………………………………...……......3

1. Решение линейного уравнения Фоккера – Планка…………………..….…5

2. Оценка параметризующих функций

2.1. Методология решения вариационной задачи …………………………….….7

2.2. Постановка и решение вариационной задачи максимизации информационной энтропии  по Клоду Шеннону……………………………..8

2.2.1. Оценка параметров решения методом моментов…….................................11

2.3. Постановка вспомогательной вариационной задачи по минимизации нормы разности двух функций………………………………………………………14

3. Решение нелинейного уравнения Фоккера – Планка

3.1 Ключевые особенности уравнения…………………………………………...18

3.2 Схема решения…………………………………………………………..……..19

4. Применение нелинейного уравнения Фоккера – Планка …………..…....26

5. Анализ результатов……………………………………………………….…...28

Список Литературы…………………………………………………………..……31

Приложения………………………………………………………………………...32







Введение

Финансовый рынок, по сути, является инструментом перераспределения средств между домохозяйствами, у которых эти средства имеются, и теми, кто в них нуждается. В качестве компенсации, кредиторы получают проценты по вкладам или дивиденды с акций. Финансовый рынок любой страны – сложная система экономических отношений, состоящая из денежного рынка и рынка капиталов. Важной частью этих двух рынков является фондовый рынок.

Фондовый рынок – это рынок, на котором торгуют особым товаром – ценными бумагами. 

Однако возможность и желание конечных обладателей прав требования на кассовые остатки инвестировать свои деньги в титулы крупнейших компаний, или, скажем, использовать иные способы преумножения своего капитала посредствам производных инструментов  (опционов, фьючерсов) сопряжена с принятием решений в условиях неопределенности. 

Основной целью моего исследования, было исследование предпосылок для создания универсального торгового правила, которое будет действовать четко в соответствии с заложенными в него инструкциями, и на выходе давать аналитику сигналы на покупку или продажу финансового актива.

Актуальность исследования объясняется возможностью последующей автоматизации торгового правила, что, на данный момент, представляет собою большой интерес у различных участников фондового рынка. Автоматизированное торговое правило, способное автономно осуществлять операции на финансовом рынке называется торговым роботом. Преимуществом торгового робота является его стрессоустойчивость, а также возможность совершать большое число операций в ограниченном временном интервале. 

Предметом моего исследования являются функции плотности вероятности, являющиеся решениями дифференциального уравнения Фоккера─Планка. Отправная точка исследования – та, что данного рода функции плотности вероятности применяются для прогнозирования финансовых рынков. 

Данная работа состоит из пяти основных глав, определенных в ходе последовательного выполнения всего спектра задач исследования. В первой главе мы рассмотрим общий вид решения линейного уравнения Фоккера – Планка, а также определим, каким образом данное уравнение применяется для прогнозирования фондового рынка. Во второй главе мы попробуем аналитически оценить значения параметризующих уравнения Фоккера – Планка функций. А также, будут даны пояснения, что же в конечном случае обозначают данные функции. В третьей главе, в свою очередь, мы займемся ключевым моментом данного исследования: научимся решать нелинейные уравнения Фоккера – Планка. В четвертой главе, используя уже полученные результаты, мы построим траектории решения уравнения Ланжевена. Наконец, в пятой главе мы подведем итоги данного дипломного исследования.

Все вычисления, связанные с выполнением исследования, проводятся в специализированном приложении Matchad.









Решение линейного уравнения Фоккера – Планка

Дифференциальное уравнение Фоккера─Планка используется в современном финансовом анализе как мощный инструмент прогнозирования финансовых рынков. Для анализа зачастую достаточно рассмотреть линейную разновидность данного уравнения: 





где      x – значение цены рассматриваемого актива,

μ(x) – математическое ожидание изменения цены актива х,

 σ(x) – дисперсия случайного изменения цены.

Для начала, отметим, что наша цель – найти такую функцию плотности вероятности, производная которой по времени равна тождественному нулю. Это означает, что данная функция будет отвечать стационарному решению данного дифференциального уравнения,  а,  следовательно, она не будет зависеть от времени:





Последовательно выполняя элементарные операции, будет получено тождество вида:



Решая последнее, получим значение функции плотности вероятности:

;

Следует отметить, что понятие функции плотности вероятности, в какой – либо точке тесно связано с вероятностью для цены принять заданное значение. Теперь, для того, чтобы оценить функцию плотности цены рассматриваемого актива, нам необходимо оценить параметры, от которых она зависит. 





























Оценка параметризующих функций

2.1. Методология решения вариационной задачи

Вариационное исчисление – это наука, в которой изучаются вариации функционалов. Функционалом является некоторое отображение, определенное на произвольном множестве и имеющее числовую область значений. Типичной задачей является поиск функции доставляющей экстремум некоторому выражению:



Стандартным является алгоритм решения, в котором сначала с помощью уравнения Эйлера Лагранжа находится  функция, которая удовлетворяет необходимым начальным условиям и возможно является решением вариационной задачи:



 ; 

То есть, если  x – решение вариационной задачи => х – решение уравнения Эйлера - Лагранжа.

Далее, следует проверить выполнение необходимых и достаточных условий достижения функцией экстремума. Необходимым условием является условие Лежандра:





Достаточным условием является условие Якоби. Согласно нему, необходимо для начала составить и решить дифференциальное уравнение Якоби:

;

Решив данное уравнение с учетом начальных условий, мы должны выяснить имеются ли на рассматриваемом интервале сопряженные точки. Если сопряженных точек нет, следовательно, условие Якоби выполнено, т.е. имеем достаточное условие экстремума функции.



2.2. Постановка и решение вариационной задачи максимизации информационной энтропии по Клоду Шеннону

В данном параграфе пойдет речь о получении альтернативной функции плотности вероятности, которая бы отвечала максимальной информационной энтропии. В свою очередь, информационная энтропия – мера непредсказуемости информации.  Она оказывается, в значительной степени полезна, когда речь идет о моделировании движения динамической системы и фондового рынка в частности.

Для анализа является существенным факт, что в прогноз закладывается некая мера неопределенности ценового процесса. Решение вариационной задачи следует начать непосредственно с составления самого функционала. В контексте данной задачи, в вариационный функционал должен входить параметр цены актива, функция распределения этой цены, функция плотности вероятности, олицетворяющая первую производную функции распределения, а также первые начальные моменты искомой функции плотности вероятности:

 ;

где    x – цена рассматриваемого актива,

   - функция плотности вероятности,

, первый начальный момент (математическое ожидание)

 второй  начальный момент

 δ·ln(δ) – основа информационной энтропии 

     (кол-во информации получаемой от сообщения)

-  стохастическое ядро ценообразования.

Наличие стохастического ядра ценообразования означает желание получить такую функцию плотности вероятности, которая не только обеспечивает максимальную неопределенность для своего класса функций, но еще и соответствует при заданной функции полезности, равновесному ценообразованию на рынке. В контексте рассматриваемой задачи, мною была взята функция полезности:



Соответственно значения  определяются как:      



Ранее мы определили, что для того чтобы решить вариационную    задачу,    прежде   всего    надо   составить   уравнение Эйлера – Лагранжа.

Данное уравнение выглядит следующим образом:

;



где     y – функция распределения,

  - первая производная функции распределения,

   - вторая производная функции распределения.

В качестве результата нам необходимо получить значение функции плотности   вероятности, а  значит  наше  дифференциальное  уравнение  Эйлера – Лагранжа в данном случае – всего лишь дифференциальное уравнение первого порядка. 

После   подстановки   нашего   исходного   функционала   в   уравнение Эйлера – Лагранжа, а также выполнения ряда элементарных преобразований, получаем следующий вид уравнения:

;

Данное уравнение – дифференциальное однородное уравнение первого порядка, решается методом разделения переменных. Его решением будет являться функция плотности вероятности, отвечающая равновесному ценообразованию на рынке:

  ;

Заметим, что в показателе экспоненты находится квадратичная функция:  







Данный результат существенно поможет нам в оценке параметров распределения искомой функции плотности. С помощью него мы можем оценивать не семь параметров, а всего три. 

Теперь перейдем непосредственно к оценке, речь о ней пойдет в следующем параграфе нашего исследования.



2.2.1. Оценка параметров решения методом моментов

Метод моментов был впервые изобретен английским математиком Карлом Пирсоном в 1894 г. Сегодня - это один из мощнейших инструментов современной математической статистики. С помощью него исследователь имеет возможность оценить параметры распределения генеральной совокупности, основываясь на данных наблюдений. Суть метода состоит в приравнивании определенного числа выборочных к теоретическим моментам. Количество неизвестных параметров однозначно определяет число уравнений в системе. Данный метод предоставляет исследователю право выбора: можно использовать как центральные, так и начальные моменты.

В моей дипломной работе, в качестве массива данных для получения выборочных моментов я использовал значения фьючерса на индекс РТС. Индекс РТС – это важный индикатор российского фондового рынка, базирующийся на акциях крупнейших компаний страны, чьи деятельности относятся к главным секторам экономики. Список компаний для входа в индекс пересматривается раз в квартал. Фьючерс на индекс РТС, в свою очередь, это производный инструмент. Заключая контракт на покупку или продажу фьючерса на данный индекс, мы осуществляем сделку на пакет акций компаний, входящих в расчет индекса.

Вернемся к нашей идее получения параметров распределения с помощью метода моментов.  Значения теоретических моментов будем оценивать по рекуррентной формуле:



где  отвечает за порядок начального момента.

Однако возникает проблема: функция плотности вероятности, которая соответствует решению вариационной задачи, представляет собою произведение константы и экспоненты в отрицательной степени. Следовательно, определенный интеграл аналитически от этой функции мы взять не сможем. Единственный способ – разложить ее в ряд Тейлора в единице. Обозначим показатель экспоненты за некоторую функцию:



Тогда нашу функцию плотности вероятности мы можем представить, как элементарное разложение экспоненты в ряд (возьмем всего 6 членов ряда):



Значит, итоговая формула для вычисления теоретических моментов распределения выглядит следующим образом:

	

Для того чтобы найти выборочные моменты, мы будем использовать стандартную функцию mean(r) приложения Matchad 15.0, которая возвращает среднее значение вектора r. Вектор r, в свою очередь, представляет собою вектор логарифмов цен фьючерса на индекс РТС, пронормированный от 0 до 2. 

Теперь, как мы уже говорили ранее, для того, чтобы получить функцию плотности вероятности необходимо составить систему уравнений. Количество уравнений в системе должно быть равно числу неизвестных параметров в общем виде функции плотности. В нашем случае неизвестных параметров три: (С,A,B), а значит, наша система будет состоять из трех уравнений:



Также при решении системы необходимо учитывать, что по определению функции плотности вероятности ее интеграл по области определения будет равен единице. Наша область формируется из области определения массива данных, по которому ведется оценка параметров распределения, а, следовательно:



Решая полученную систему относительно трех неизвестных переменных, получим следующие значения для параметров искомой функции:



Исходя из данного результата, искомая функция плотности вероятности, соответствующая вариационной задаче по максимизации информационной энтропии, будет представлять собою:

;



2.3. Постановка вспомогательной вариационной задачи для минимизации нормы разности двух функций

И так мы научились получать функции плотности вероятности двумя различными способами: с помощью решения линейного вида уравнения Фоккера – Планка, а также с помощью постановки вариационной задачи по поиску функции максимизирующей информационную энтропию по Клоду Шеннону. Но встает справедливый вопрос о необходимости проделанной работы. Повторюсь, наша задача состоит в том, чтобы наша искомая функция плотности вероятности отвечала и уравнению Фоккера – Планка и решению вариационной задачи. Необходимо, чтобы эти две функции минимально отличались друг от друга. Это требование натолкнуло меня на мысль о постановке вспомогательной задачи вариационного исчисления. Нужно поставить условие того, что норма разности двух функций будет минимальной, что соответствует:

  

Это требование отвечает типичной задаче вариационного исчисления, а значит, мы будем ее решать путем последовательного выполнения всех этапов вычислений, описанных в первом параграфе данной главы.

Для начала, запишем дифференциальное уравнение Эйлера – Лагранжа. Для полноты, приведем шаги вычислений:

 ;

  ;

Соответственно само уравнение после ряда элементарных преобразований будет выглядеть следующим образом:





Получено уравнение Эйлера – Лагранжа, которое может быть решено относительно . Однако, для нахождения двух неизвестных  и , мы должны иметь систему из двух дифференциальных уравнений. Второе уравнение получим аналогично первому:



В результате преобразований, второе уравнение системы принимает рекуррентный вид:

(x)

Теперь, мы имеем систему из двух уравнений:



Выразим одно неизвестное через другое, как пример,  через  во втором уравнении системы. Затем подставим этот результат в первое уравнение. Получим, что нуль тождественно равен нулю. Данный результат наталкивает нас на мысль, что функция  может быть произвольной. Однако общий вид функции  напрямую влияет на функцию . Соответственно, данная вариационная задача помогла нам понять общий вид зависимости двух неизвестных функций, но не помогла нам найти их как таковые. В литературе зачастую  определяется в виде скаляра или в виде полинома различных степеней.  Возьмем  в виде многочлена первой степени:

 = k·x

Отсюда подставляя  = k·x в ранее полученную формулу, 

=k–k·x·(x) 

Теперь подставим данный результат в решенное в главе I линейное уравнение Фоккера – Планка:

  

Получим, что:  			



Рис.1. Решение линейного уравнения Фоккера – Планка







Решение нелинейного уравнения Фоккера – Планка

Ключевые особенности уравнения

В предыдущих главах моего исследования я уже рассказывал о решении дифференциального уравнения Фоккера – Планка в линейном случае. Для нелинейного случая алгоритм представляет собою последовательность нетривиальных переходов, которые, будут в полной мере описаны в рамках текущей главы. 

Мы начнем с того, что определим факт, что искомая функция плотности вероятности не будет зависеть от времени, а значит, ее производная по времени будет равна нулю. Далее, мы сведем полученное дифференциальной уравнение второго порядка к дифференциальному уравнению первого порядка типа Бернулли. В контексте данной задачи, уравнение Бернулли примет вид неоднородного дифференциального уравнения первого порядка, которое мы будем решать методом вариации постоянной. Затем, мы построим траектории решения искомого нелинейного уравнения Фоккера – Планка, чтобы определить, как изменяется функция плотности вероятности на интересующем нас множестве значений цен. Ограничения, накладываемые по ходу решения уравнения, будут определяться ключевыми особенностями рассматриваемой области определения исходных данных для нашего исследования.

Вообще, следует подчеркнуть, что нелинейная вариация направлена на рассмотрение случая, отвечающего большей неопределенности информации. Данный факт является ключевым в прогнозировании фондового рынка. Инвестор никогда не обладает всей полнотой информации, а значит, вынужден принимать решения в условиях неопределенности. 





 3.2 Схема решения

Нелинейное дифференциальное уравнение Фоккера – Планка выглядит следующим образом:

;     (1)

Повторюсь, наша задача найти такую функцию плотности вероятности, которая не зависит от времени, а значит:

;

Где       		  ()                  		  (2)

;	;

Из (1) и (2) следует:	



В соответствии с определенными ранее этапами решения, нам необходимо привести уравнение (1) к дифференциальному уравнению первого порядка типа Бернулли. Для этого, интегрируем обе части уравнения по dx:



В контексте данной задачи, примем  ,  тогда



Или, что эквивалентно



Так как решение стационарное то  (), тогда имеем:

;

Делим все слагаемые в данном уравнении на  

Тогда получаем:  

;

            +;

Сделаем замену переменных:		      

();   (;

В результате чего уравнение принимает вид:

         ;

Выполним еще одну замену переменной:

,

Заметим, что  







 ;

Теперь получаем:



   () ;       		 	          (3)

После наших преобразований, имеем неоднородное уравнение (3). Теперь переходим к этапу решения данного неоднородного уравнения:

Решаем сначала однородное уравнение:

 () ;

 () ;

 ()

;

 ;

Теперь решаем неоднородное уравнение методом вариации постоянной:

Ищем решение в виде	 ;

;

  ;

 () ;

   ();

  ()

 ;



 ()

 ();



;

    ;

  ;

Тогда решение неоднородного уравнения представляется в виде:

;

 так как	        , т.е.

;

;

 	Исходя из идей о простоте решения, а, также, не нарушая общности задачи, примем n=2, k=1. Тем самым в рамках данного исследования мы будем рассматривать более частный случай решения нелинейного уравнения Фоккера – Планка.



Так как 

 ;	  ;

Воспользуемся найденными в третьем параграфе главы 2 значениями параметризующих функций, а именно:

                                			   ;

				      

То				 ;

;

Тогда имеем:

;	



где 		

		

Следует отметить, что границы интеграла находятся исходя из области определения исходных данных, по которым мы оценивали функцию плотности вероятности являющеюся решением вариационной задачи по максимизации информационной энтропии. Однако, в решении нелинейного уравнения Фоккера – Планка имеются функции не определенные в нуле. Тогда обозначим тот факт, что мы рассматриваем решение не в нуле, а в некоторой его малой окрестности.

Аналитически интеграл соответствующий решению нелинейного уравнения Фоккера – Планка вычислить не предоставляется возможным, поэтому воспользуемся уже знакомым нам методом: разложим экспоненциальную функцию плотности вероятности под интегралом в ряд Тейлора в единице. В условиях данной задачи, достаточно будет взять первые пять членов ряда:



где является степенью экспоненты



Рис 2. Решение нелинейного уравнения Фоккера - Планка























4. Применение нелинейного уравнения Фоккера - Планка

Нелинейное дифференциальное уравнение Фоккера – Планка задает эволюцию функции плотности вероятности во времени. Главным образом в прогнозировании фондового рынка она применяется для построения траекторий решения уравнения Ланжевена, которое, в свою очередь, является стохастическим дифференциальным уравнением первого порядка. Уравнение Ланжевена используется в финансовом анализе для исследования динамики ценового процесса. Исходя из динамики, мы можем сделать значительные выводы относительно того, насколько волатильным является исследуемый актив.  Волатильность – финансовый показатель, характеризующий некоторую степень изменчивости цены исследуемого объекта. Она является важной характеристикой, и представляет собою особый интерес для исследования, ведь понятие волатильности тесно связано с понятием риска. Ни одна торговая стратегия не имеет реальной ценности, если она сопряжена с высокой степенью риска. В связи с данным фактом, любой аналитик, создающий торговый алгоритм, анализирует насколько волатильным является торгуемый им инструмент. Это является ключевым моментом, ведь значительное изменение цены инструмента напрямую влияет на риски, не соблюдение которых, может привести к потере денежных средств.

В моем исследовании мы не обошли стороной данный момент. Мы исследовали, как будет изменяться цена актива при соответствующих параметризующих функциях в случае нелинейного уравнения Фоккера - Планка:

 ;

где  x – значение цены рассматриваемого актива,

μ(x) – математическое ожидание изменения цены актива х,

σ(x) – дисперсия изменения цены актива,

	 - Гауссовский нормальный генератор случайных чисел

 – Значение функции плотности для решения нелинейного уравнения Фоккера – Планка

В случае, когда мы имеем дело с решением линейного уравнения Фоккера – Планка, траектории решения уравнения Ланжевена будут определяться из уравнения:





Тогда для полученных в ходе исследования параметризующих функций, среднее множество траекторий уравнения Ланжевена в линейном и нелинейном случаях решения уравнения Фоккера – Планка будут выглядеть следующим образом:



Рис 3. Траектории уравнения Ланжевена (синим – для нелинейного уравнения Фоккера – Планка, красным – для линейного вида)

Траектории, представленные на графике – симуляция движения цены актива во времени, при заданных параметрах: математическом ожидании отклонения цены, дисперсии данного отклонения, а также функции плотности вероятности, соответствующей решению нелинейного дифференциального уравнения Фоккера - Планка. Значимым моментом является то, что мы взяли не одну из симуляций, а некую среднюю из множества возможных. Это дает нам основания утверждать, что в условиях данной задачи, построен некоторый прогноз движения цены актива. Анализируя данную диаграмму, важно отметить факт, что мы получаем существенно различные результаты при использовании линейного уравнения Фоккера – Планка или его нелинейной вариации. Кроме того, исходя из данной диаграммы мы можем сделать выводы о том, насколько изменчива будет цена актива с течением времени.

























5. Анализ результатов

В данной дипломной работе мы изучали возможность построения эффективного торгового алгоритма, основанного на решениях дифференциального уравнения Фоккера – Планка. Данные решения представляют собою функции плотности вероятности цен акций компаний, входящих в индекс РТС.

Данная дипломная работа представляет собою последовательное выполнение пяти ключевых этапов исследования. Мы начали с того, что рассмотрели множество решений линейного уравнения Фоккера – Планка, затем, для того, чтобы определить параметризующих данное уравнение функции, мы перешли к решению вариационной задачи по поиску функции плотности вероятности, максимизирующей информационную энтропию по Клоду Шеннону. Далее, мы занялись постановкой и решением вспомогательной вариационной задачи по минимизации нормы разности двух функций, полученных на предыдущих этапах исследования. После этого, мы перешли непосредственно к решению нелинейного случая уравнения Фоккера – Планка.

Основным результатом моего исследования явились значительные предпосылки к созданию торговой стратегии. Во-первых, я научился моделировать на основе общих решений уравнения Фоккера – Планка, функцию плотности вероятности цены актива. Во-вторых, научился находить функцию плотности вероятности не только максимизирующую информационную энтропию, но и отвечающую равновесному ценообразованию на рынке. В третьих, я исследовал, как в течение времени будет изменяться цена исследуемого актива.

В заключении, я хотел бы отметить, что на данном этапе, исследование представляет собою исключительно научный интерес. Множество предпосылок и упрощений, используемых в данной работе, неприменимо в случае торговли на реальных денежных средствах. Однако данное исследование заложило прочный фундамент в понимание многих процессов фондового рынка, а также методов его прогнозирования. 



































Список литературы

Зайцев В.Ф., Полянин А.Д., Метод разделения переменных в математической физике (Книжный дом, 2009г.).

Фадеев Л.Н., Лебедев А.В., Теория вероятностей и математическая статистика (Москва: Эксмо, 2010г.)

Малинецкий Г.Г., Потапов А.Б., Современные проблемы нелинейной динамики (Москва: Эдиториал УРСС, 2000г.)

Алексеев В.М.,  Тихомиров В.М.,  Фомин С.В.,  Оптимальное управление, М., Физматлит, 2007

Гельфанд И.М., Фомин С.В.  Вариационное исчисление, М. Наука, 1961. 

Risken, H.: The Fokker-Planck Equation. Methods of Solution and Applications, 2nd ed. (Springer-Verlag, Berlin, 1989)

Voit, J.: The Statistical Mechanics of Financial Markets, 3rd  edition (Springer-Verlag Berlin Heidelberg, 2005).

Берзон Н.И., Аршавский А.Ю. - Фондовый рынок, Издательство: Вита-Пресс, 1998г.

Финансовый портал 











Приложения

diploma_bobrovsky_2014..xmcd

langeven_bobrovsky_2014.xmcd

stationary_bobrovsky_2014.xmcd

var1_bobrovsky_2014.xmcd