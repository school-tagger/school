Правительство Российской Федерации

Федеральное государственное автономное образовательное учреждение высшего профессионального образования

«Национальный исследовательский университет 
«Высшая школа экономики»





Факультет «Экономика»

Кафедра финансового менеджмента                



Допускаю к защите

Заведующий кафедрой

Кандидат экономических наук 

Шакина Елена Анатольевна 



 «______» __________________2013 





ВЫПУСКНАЯ КВАЛИФИКАЦИОННАЯ РАБОТА



на тему КОмбинированные торговые системы ТЕСТИРОВАНИЯ НА РОССИЙСКОМ фондовом рынке



Студент группы Э-09-1

Чеботарев Дмитрий Александрович



________________________

подпись 



Научный руководитель

Преподаватель кафедры

 финансового менеджмента

Паршаков Петр Андреевич



________________________

подпись 













Пермь 2013

Оглавление 

Введение	3

Глава 1. Теоретические аспекты предсказательного моделирования	6

1.1.	Обоснование предсказуемости рынка	6

1.2.	Методы и модели прогнозирования	11

1.3.	Комбинирование моделей прогнозирования	15

Глава 2. Комбинированная торговая система для российской биржи	17

2.1.	Алгоритм действий работы с КТС	17

2.2.	Состав портфеля	19

2.3.	Модели прогнозирования	19

2.4.	Результаты моделей прогнозирования	24

2.5.	Принятие решений	36

Заключение	44

Список использованной литературы	46

Приложение 1	50






Введение



Еще с середины прошлого столетия академиков, инвесторов и прочих участников рынка особенно интересовала возможность предсказания движения рынка по тому или иному активу. Существуют различные гипотезы, принадлежащие к разным временным периодам. Некоторые из них утверждают, что прогнозирование цен – невозможно, другие – верят в возможность предсказания в определенных условиях. Торговые системы - базируются на последних. Об этом и пойдет речь в данной работе. 

Что же представляют собой торговые системы? ТС – это набор правил, которые определяют необходимые условия для открытия сделки или выхода из нее. (Tushar, 1997) Другими словами, это программа, которая полностью или частично автоматизирует торговые процессы. Она может служить как помощью для инвестора или трейдера для принятия решения, так и быть самостоятельным торговым ботом, который способен сам исполнять сделки на реальных счетах.

Поскольку “свойства рынка изменяются с течением времени” [25, c 3], задача поиска предсказательных инструментов усложняется. Модели, которые работали в прошлых периодах, могут оказаться не эффективными на последующих периодах. Из этого следует несколько проблем, с которыми сталкиваются инвесторы. Во-первых, горизонт прогнозирования ограничен. Во-вторых, необходимо постоянно искать новые модели. Если была обнаружена модель, прогнозные значения которой позволяли бы получать сверхприбыль, т.е. прибыль превышающую рост рынка в целом, то она была бы эффективна лишь ограниченное время. Это вызвано тем, что, с течением времени, информация доходит до участников рынка. Все больше инвесторов используют модель, ее эффективность понижается, она перестает работать. Необходимо искать новую модель. Постоянный поиск лучших моделей – особенность комбинированной торговой системы. Каждый период производятся тесты всех имеющихся моделей, в рамках КТС, на ретроспективных данных для выбора моделей с наилучшими показателями. Прогноз на следующий период будет построен именно по данным моделям. 

В данной работе рассматривается российский рынок ценных бумаг с целью проверить эффективность и работу в целом комбинированной торговой системы на данном рынке. Роль Российского фондового рынка сравнительно мала, он составляет 2,4% от совокупной капитализации крупнейших финансовых рынков мира. [1, с. 47-50] В какой-то мере это связанно с низкой финансовой грамотность населения в России, которая сильно отстает от стран Европы и США. Причиной этому, возможно, является особенности исторического развития России, т.е. социалистический строй и стремительный переход к рынку в 90-е годы. Всего около 2% населения имеют опыт покупки или продажи ценных бумаг за деньги, в то время как в США больше половины населения,  так или иначе, связаны с фондовым рынком. [2, с. 1] Но с каждым годом финансовая грамотность растет, все больше человек открывают счета в брокерских компаниях и торгует на фондовом рынке. Ведь рыночной экономике в России всего 20 лет, она быстро развивается. Если население, которое выросло в социализме, мало интересуется финансовыми инструментами, биржей, то поколение, получившее образование уже в капиталистической России проявляет интерес к торгам. С каждым годом вырастают новые инвесторы. Появление большого количества новых игроков на бирже делает вопросы относительно финансовых инструментов еще более актуальными. В частности, возрастает применение торговых систем и растет спрос на них. Ведь, как уже было сказано ранее, торговые системы пытаются решить проблему, с которой сталкивается любой участник биржи – получение прибыли выше роста индекса. 

Таким образом, целью данной выпускной квалификационной работы является изучение методики построения прогнозирующих моделей и их применение в комбинированной торговой системе, которая имеет практическое применение и тестируется на российской бирже. 

Для достижения цели необходимо выполнить следующие задачи:

Изучение теоретической подоплеки данной темы: предсказуемость цен, способы построения моделей прогнозирования, оценка моделей, использование инструментов прогнозирования в КТС, комбинирование моделей и т.д.;

Применение теории для создания комбинированной торговой системы для работы на российской бирже, оценка созданной КТС – бактестинг.

Данные задачи отражаются в главах данной работы соответственно:

Глава 1 – «Теоретические аспекты предсказательного моделирования». Данная глава включает в себя обоснование предсказуемости, применение и построение различных методов и моделей прогнозирования;

Глава 2 – «Комбинированная торговая система для российской биржи». В ней представлена созданная в ходе проекта КТС, ее составляющие, принцип работы и результаты. 

Предметом данного исследования является методика построений предсказательных моделей и инструменты прогнозирования. Объектом исследования являются акции компаний, торгующихся на РТС. В частности, голубые фишки – Сбербанк, ВТБ, Газпром, Лукойл, Роснефть, Ростелеком, МТС, ГМК Норильский Никель, Аэрофлот. 



Глава 1. Теоретические аспекты предсказательного моделирования







Данная глава содержит необходимые теоретические знания для подготовки к работе КТС и понимания принципа ее работы. Поскольку торговая система строится на прогнозе цен, в первую очередь, необходимо обосновать возможность предсказания на фондовом рынке. Эта тема берет истоки из гипотезы эффективных рынков – ГЭР, из которой вытекает гипотеза адаптивных рынков. Именно на принципе ГАР строится возможность обыграть рынок и сама КТС. В первых пунктах данной главы описана история и основные принципы данных гипотез. Обосновав возможность предсказания цен, следует разобрать методы прогнозирования и прогнозирующие модели. Далее, чтобы выбрать лучшие модели, необходимы критерии оценки. Подробнее об этом в соответствующих пунктах главы 1. 



Обоснование предсказуемости рынка



Сама по себе ГЭР гласит, что рынок невозможно обыграть, он эффективен. Цены изменяются непредсказуемо, используя модели невозможно обогнать доходность по индексу. Но существуют предпосылки, которые сильно отличаются от действительности. Такие, как абсолютная рациональность индивидов и доступность всей информации всем участникам рынка. Чтобы понять - возможно ли обыграть рынок, необходимо начать с изучения ГЭР и вытекающей из нее ГАР. Возможно, рынки не всегда эффективны, ведь есть люди, которые зарабатывают больше индекса в течении длительного времени. 







Гипотеза эффективных рынков



История ГЭР начинается с работ двух экономистов, работающих независимо друг от друга. Их имена – Пол Самуэльсон и Юджин Фама. Они оба пришли к понятию эффективности рынка с различными исследованиями. Статья Пола Самуэльсона “Доказательство случайного изменения рационально ожидаемых цен” была опубликована в 1965 году. Согласно данной статье, «в информационно эффективном рынке, изменения цен должны быть непредсказуемыми, если они рационально ожидаемы, т.е. они полностью учитывают информацию и ожидания всех участников рынка». (Timmerman, 2007) Он разработал ряд решений линейного программирования к пространственным ценовым моделям без неопределенности, которые привели его к идеи эффективных рынков. Фама, в свою очередь, был заинтересован в измерении статистических свойств цен акций и в разрешении спора между техническим (использование геометрических тенденций в графиках цены и объема для прогноза будущих изменений цены ценной бумаги) и фундаментальным (использование финансовой отчетности и экономических сведений для определения справедливой стоимости ценной бумаги) анализом. Он дал новое описание гипотезе: “цены полностью отражают всю доступную информацию”, “чем более эффективен рынок, тем более независимо изменяются цены на таком рынке; самый эффективный рынок из всех – рынок, на котором цены абсолютно независимы и непредсказуемы. (Lo, 2004) Многие известные экономисты продолжили работу над ГЭР. И через 10 лет после публикации Самуэльсона появилась неоклассическая версия гипотезы. Согласно которой, “изменения цен, правильно взвешенных по совокупной предельной полезности, должны быть непредсказуемыми”. (Lo, 2007) Данная гипотеза появлялась в работах известных экономистов: Лерой (1973),  Рубинштейн (1976), Лукас (1978). Последний в своей работе пишет, “на рынке, на котором все участники имеют рациональные ожидания, цены полностью отражают всю доступную информацию и цены, взвешенные по предельной полезности, следуют мартингалам. «Мартингал - это последовательность чисел (процесс) у которого математическое ожидание следующего значения при условии знания всех предыдущих значений ряда равно последнему значению.  Самым простым мартингалом является броуновское (экономическое) случайное блуждание. Предполагается, что все биржевые цены являются мартингалами. Случайные приращения в мартингале зависимы в том смысле, что зависимы стандартные отклонения приращений цен. Если ряд цен является мартингалом, то технический анализ (предсказывание будущего на основе истории цен) бессилен и не может дать прибыльную стратегию». [13] 

Впоследствии, гипотеза эффективного рынка развивалась в различных направлениях. Последняя версия ГЭР может быть описана “тремя П Полного Инвестиционного Менеджмента (three Ps of Total Investment Management)”: цены, вероятности и предпочтения. Так пишет Эндрю Ло в 1999 году. (Lo, 2007) Его теория берет начало в принципе спроса и предложения. Пересечение двух кривых определяет равновесие. Кривая спроса – объединение желаний многих потребителей, а кривая предложения – объединение выпуска множества индивидуальных производителей. Обе кривые зависят от цен, доходов, издержек и прочих факторов. Три П одновременно определяют общее равновесие, при котором спрос равняется предложению на всех рынках в неопределенном мире, где агенты и корпорации ведут себя рационально, оптимизируя свое благосостояние. Известные экономисты, как Лерой, Мертон, Рубинштейн, Лукас показали этот процесс на моделях цен финансовых активов. “Три П входят в любое экономическое решение под неопределенностью”. (Lo, 2007)

Так или иначе, согласно ГЭР, рынок эффективен, цены предсказать невозможно. Но данная теория не совсем сопоставима с реальностью. Ведь, время от времени появляются модели, прогнозы которых позволяют опережать доходность индекса. Так, например, до 80-ых годов прошлого века существовала предсказуемость динамики стоимости активов от темпа инфляции и дивидендного дохода. Но, после того как Фама опубликовал данную информацию, зависимость ослабла, т.е. неэффективность рынка исчезла. 



Гипотеза адаптивных рынков



Критика ГЭР со стороны поведенческих экономистов и психологов привела к появлению новой гипотезы – гипотеза адаптивных рынков или ГАР. На этот эволюционный подход повлияло недавние развитие новой дисциплины – эволюционной психологии. В центре – идея применении принципов конкуренции, размножения и естественного отбора к социальным взаимодействиям,  получая удивительно убедительные объяснения для некоторых видов поведения человека, таких как альтруизм, справедливость, родство, язык, партнерство, религия, мораль, этика и абстрактное мышление. (Lo, 2004) Данный подход утверждает, что “индивиды ограничены в рациональности”, что означает, что индивиды делают выбор удовлетворительный, не обязательно оптимальный. Данные индивиды определяют точку, когда их оптимизированное поведение удовлетворительно, не аналитически, а путем проб, ошибок и естественного отбора. Это означает, что выбор базируется на опыте и удаче (путем угадывания). (Lo, 2004) Объединение ГЭР и сохранение поведенческих склонностей образовали ГАР.

Гипотеза адаптивных рынков может быть сопоставлена с биологическим  миром вокруг нас. “Возможность получения прибыли на любом рынке сродни количеству пищи и воды в той или иной экологии – чем больше ресурсов осталось, тем менее ожесточенная конкуренция. Когда же конкуренция увеличивается из-за роста населения или снижения запасов – ресурсы будут исчерпаны, что, в свою очередь, вызовет уменьшение населения, уменьшая конкуренцию. Данные события повторяются или обрываются, приводя к вымиранию некоторых видов”. (Lo, 2004) Эндрю Ло уверен, что принимая экономическую прибыль как абсолютный источник пищи, от которого зависит выживание участников рынка, динамика рыночных взаимодействий и финансовых инноваций может легко быть выведена. (Lo, 2004) Как только информация о возможности получения высокой прибыли распространяется по финансовому рынку, данная возможность исчезает. Эмоции, как страх и жадность, являются важным фактором в процессе принятия решения. Существует связь между эмоциональными и поведенческими склонностями. В конце двадцатого века экономисты Дамасио и Роллс утверждают, что эмоции занимают центральное место в рациональности. Дамасио заявил, что “эмоция – мощная адаптация, которая сильно увеличивает эффективность, с которой животные учатся из окружающей среды и их прошлого”. (Lo, 2004) Из теоретического, эмпирического, экспериментального анализа эволюционного подхода, можно заметить, что отношение риск – доходность не стабильно во времени. Предпочтения по риску не всегда постоянны, они формируются силами естественного отбора. 

ГАР все еще находится в состоянии развития. Ее публикация послужило началом новым исследованиям в экономике, финансах, психологии. Объединив результаты этих исследований можно получить полное понимание того, как индивиды принимают решения. 



Предсказуемость на рынке



Из ГАР следует, что индивид может принимать не только оптимальные решения, достаточно, чтобы они были удовлетворительными. Используя это условие, появляется возможность неэффективности рынка. Но неэффективности рынка со временем исчезают, когда информация постепенно доходит до всех участников рынка. Так, например, в 70-ые годы прошлого века цены на нефть были индикатором цен бумаг на фондовом рынке. Однако, со временем данная информация стала очевидна для всех участников рынка, неэффективность исчезла. Тогда, с точки зрения инвестора, рациональным и наиболее выгодным будет решение постоянного поиска новых неэффективностей. В чем и заключается работа КТС. Возможно, неэффективности система не найдет, но модель, более всего подходящая и стремящаяся к возможной неэффективности рынка, будет выбрана.



Методы и модели прогнозирования



Поскольку ТС функционирует в течение нескольких периодов, необходимо определить, как будет изменять ретроспективный период. Под ретроспективным периодом, в данном случае, понимается промежуток времени, данные за который используются при расчете прогнозных котировок.  Существует два подхода к изменению ретроспективных данных с наступлением нового периода: метод скользящего окна и метод нарастающего окна. 

ТС работает с котировками цен акций, и ее главная задача – это прогноз котировок на следующий период. Но какие модели стоит использовать при прогнозе котировок и как построить прогноз? И, в случае КТС, как определить лучшие модели, какие критерии использовать? Ответы на эти вопросы можно найти в данном параграфе.



Метод скользящего окна



Данный метод определяет изменение ретроспективного периода с течением времени. Идея данного метода заключается в использование только последних данных для прогноза. В таком случае, считается, что данные за первые периоды устаревают и их можно не включать в модель. Тогда, с каждым новым периодом, ретроспективный период будет “сдвигаться” на один шаг. На рисунке 1 изображена схема принципа работы данного метода.


























Рис. 1. Метод скользящего окна





При использовании данного метода, как правило, веса наблюдениям в разные периоды не раздаются, считая, что каждое значение одинаково важно для прогноза. Компенсируется это тем, что ретроспективный период ограничен и не меняет свою длину. Главная сложность – как правильно выбрать длину окна. 



Метод нарастающего окна



В отличие от предыдущего метода, метод нарастающего окна увеличивает длину ретроспективного периода с течением времени. Данные за каждый новый прошедший период добавляются к уже имеющимся ретроспективным данным. Из-за того что ретроспективный период может становиться слишком длинным, старые данные менее важны и меньше влияют на будущие котировки. Поэтому, можно использовать постепенное изменение коэффициентов модели в зависимости от временного фактора. (Mamaysky, 2006) Схема функционирования данного метода изображена на рисунке 2. 

















                                    

           Рис.2. Метод нарастающего окна





Длина окна при использовании данного метода может быть разной. Поскольку, как правило, с течением времени данным присваиваются разные веса, ретроспективный период может быть очень длинным. 



“Толстое” моделирование



Само по себе толстое моделирование является комбинацией моделей. В отличие от “тонкого” моделирования, которое базируется лишь на одной модели с лучшим результатом, “толстое” использует комбинацию моделей со статистически близкими результатами. При использовании “толстого” моделирования прогнозы оказались более точными. Так показывает исследования Аиолфи и Фаверо в 2002 году. В работе Кэмпбелла  1997 года “The econometric of financial markets” рассматривалась максимизация предсказуемости портфеля из акций и облигаций, решением было множество вариантов. Авторегрессии, нелинейные модели, модели с разными факторами и с изменяющимися во времени параметрами регрессии были успешными, но не одинаково эффективными. Нехватки моделей и техник для предсказания нет. Модели покажут временную предсказуемость, если она есть. Модели по статистическим показателям могут оказаться близкими, тем самым показывая свою успешность. Отказываться от всех в пользу одной может понизить точность прогноза, поэтому следует использовать комбинацию моделей.



Прогнозирующие модели



Во все прогнозирующие модели, использующиеся торговой системой, так или иначе, входит переменная, показывающая динамику изменения цены актива. Но возникает проблема – цена не стационарна, что, с точки зрения эконометрики, не позволяет использовать модели для прогноза с такой зависимой переменной. Для решения проблемы стационарности ряда можно использовать доходность актива вместо цены. Она вычисляется как разность между текущей ценой и ценой за прошлый период, поделенная на цену в прошлом периоде: 





,

где E – доходность;

P2 – цена бумаги в текущем периоде;

P1 – цена бумаги в прошлом периоде.





Поскольку цены текущего периода сильно зависят от прошлых котировок, что логично, то хорошие результаты показывают модели авторегрессии, с использованием лагов. На рыночную цену бумаги может влиять множество факторов. Поэтому, чтобы повысить эффективность торговой системы за счет более успешных прогнозов, большое количество моделей с разными факторными переменными является неотъемлемой частью КТС. Подробнее об использующихся моделях можно найти во второй главе данной работы.

Критерии оценки моделей



Одним из самых важных аспектов для КТС является определение лучших моделей. Какие показатели эффективности использовать? Как их интерпретировать? Какие более значимы? Однозначного ответа на эти вопросы нет. Показатель R2 может быть экономически мало значимым, как пишут Кэмпбелл и Томпсон в 2004 году. (Campbell, 2004) Данные экономисты предлагают использование показателя R2/S2 для оценки качества модели. S2 в данном случае является коэффициентом Шарпа. Но отказываться от R2 не стоит. В 2007 году Тиммерман использовал его как вариант оценки качества модели. (Timmerman, 2007) 

Показателем эффективности модели может служить и успешность последнего прогноза. Другими словами, чем лучше модель спрогнозировала котировки на последний период, тем выше ее оценка. В количественном выражении оценка представляет собой разницу между реальными значениями последнего периода и прогнозным значением модели на тот же период. Данный подход выбирает не всегда самую лучшую модель, поэтому его не стоит использовать как единственный критерий для “тонкого” моделирования, но как составляющую оценок для “толстого” – можно.



Комбинирование моделей прогнозирования



Алан Тиммерман в 2007 году публикует статью “Экономическое прогнозирование”, идеи которой являются принципом работы КТС. Автор статьи пишет: “модели экономических и финансовых временных рядов обычно нестабильны во времени, поэтому предсказательные модели лучше всего рассматривать как “приближения” или устройства слежения. Следовательно, не стоит ожидать, что одна и та же прогнозирующая модель будет доминировать в различных исторических периодах. … Комбинация моделей позволяет защищаться от неопределенности и сдвигов моделей”. (Timmerman, 2007)  Данный принцип использует КТС, постоянный выбор в пользу комбинации лучших моделей, каждый период новые лучшие модели используются для прогноза. 

Следует уделять особое внимание ретроспективному периоду и факторным переменным. Более длинный период и большее количество факторов не всегда приводит к более точному результату, т.к. сложно учесть особенности периодов (кризис, период роста и т.д.), а новые параметры переносят ошибки параметра оценки на модель. (Timmerman, 2007)



Теория данной главы необходима для построения функционирующей комбинированной торговой системы. Ведь ТС – лишь набор действий, которой строится на прогнозах, полученных из моделей прогнозирования. Как правильно построить и выбрать модели – основная задача участника рынка при создании торговой системы. Следуя данной теории можно избежать многих ошибок и максимизировать эффективность моделей и ТС в целом. 

Глава 2. Комбинированная торговая система для российской биржи







В данной главе разобрана функционирующая комбинированная торговая система для российского фондового рынка. Она была создана с помощью программного пакета R. Полностью автоматизированная торговая система – торговый бот. В данной работе КТС представляет собой лишь основания для принятия решения инвестору. Выполняя сделки следуя прогнозам торговой системы, можно отследить эффективность работы или доходность данной КТС. Подобная система строит прогнозы по активам, определяет показатели эффективности моделей, на основании которых выбирается комбинация лучших моделей, по которым строится прогноз. На выходе получаем прогнозное значение доходности по ценным бумагам, поскольку в моделях котировки учтены как доходности. Исходя из прогнозного значения доходности, инвестор принимает решение об открытии лонг или шорт позиции или принять решение не совершать сделок по данному активу.  



 Алгоритм действий работы с КТС



Алгоритм действий создания системы и весь процесс принятия решений, на основе которого была построена КТС в данной работе:



Отбирается набор активов, интересующих инвестора;

На основе корреляции с рынком, отрасли, и прочих показателей для диверсификации все активы делятся на группы;

Для каждого актива создается набор прогнозирующих моделей с разными факторами и методами прогнозирования;

На основе ретроспективных данных каждая модель тестируется для каждого актива;

На основе тестов выбирается комбинация лучших моделей для каждого актива;

Строятся прогнозы для каждого актива;

В рамках группы выбирается актив или несколько активов с лучшими показателями прогноза (если набор активов, то каждому активу присваивается вес внутри группы, исходя из показателей прогноза, личных предпочтений инвестора, уверенности в полноте информации для конкретного актива);

Анализируются данные по группам, на основе прогнозов, предпочтений инвестора,  какой-либо дополнительной информации, учитывая диверсификацию, каждой группе присваивается вес в портфеле инвестора;

Имея веса для каждой группы и активов можно составить портфель;

Каждый новый период все модели снова тестируются уже на обновленных данных, выбирается новая комбинация лучших моделей, строятся новые прогнозы;

На основании новых тестов вносятся корректировки в портфель: некоторые активы продаются, некоторые стоит купить, какие-то останутся без изменений.



Подобная торговая система может работать самостоятельно, ее можно автоматизировать. Но для получения более высоких результатов инвестор может вносить корректировки в состав моделей, изменить их вид, добавлять новые модели и факторы в модели. Ведь торговая система не может самостоятельно интерпретировать новую информацию. Поэтому желательно вносить корректировки каждый раз, как на рынке появляется новая весомая информация. 





 Состав портфеля



Следуя алгоритму, предложенному в предыдущем пункте, определимся с выбором ценных бумаг и распределим их по группам. Поскольку российская биржа отстает от своих западных аналогов и количество игроков на рынке небольшое, то стоит использовать только голубые фишки. Это вызвано тем, что если использовать акции компаний второго эшелона, а ликвидность  ценных бумаг у таких компаний низкая, то появляется риск невозможности открыть или закрыть позиции по желаемым ценам (большой разрыв между ценой покупки и продажи или отсутствие продавцов/покупателей на рынке). К голубым фишкам относятся только самые крупные российские компании. Для диверсификации рисков компании для КТС были выбраны из разных отраслей:

ОАО «Сбербанк России» – финансы,

ОАО «Газпром» – нефтегазовая промышленность,

ОАО «Ростелеком» – телекоммуникации, 

ОАО «Аэрофлот» – транспорт.

Все эти бумаги высоко ликвидны. Но, тогда возникает проблема шумовой торговли. Шум ведет к проблеме ложных сигналов. Это приводит к тому, что модели находят предсказуемость на временном отрезке, где ее на самом деле не существует.  Появляется фиктивная предсказуемость. В данной работе произведена попытка уменьшить влияние шумовой торговли путем использования более продолжительных периодов. Длина одного периода – одна неделя. Ретроспективный период – от 3 до 10 лет, в зависимости от модели, что означает, что наблюдений от 150 до 500. Прогнозный период – с января по май 2013 года. Котировки используются на момент закрытия.



 Модели прогнозирования



Для прогнозирования были использованы разные прогнозирующие модели:

ARIMA;

линейные с различными факторными переменными;

экспоненциальное сглаживание;

нейросети.

В качестве факторных переменных были взяты следующие данные:

нефть марки Brent;

индекс ММВБ;

валютная пара USD-RUB;

индекс S&P 500.

Ретроспективный период был разный в разных моделях. Использовался как метод скользящего окна, так и нарастающего окна. Для скользящего окна ретроспективный период составил 3 года – с 14 января 2010 года до января 2013 года. Период был выбран именно таким, чтобы не учитывать кризис и выход из него 2008-2010 года. По графикам котировок видно, что многие компании восстановили большую часть своей стоимости в 2010 году. Метод нарастающего окна использовался на данных с начала 2006 года до начала 2013 года. Ретроспективный период составил 7 лет, что около 350 наблюдений. Используя различные методы изменения ретроспективного периода, различную длину этого периода, разные факторные переменные и типы моделей всего для каждого актива было построено около 10-15 моделей. По каждой модели были построены прогнозы и выбраны лучшие модели по трем критериям оценки: R2, R2/S2, разница между реальным и прогнозным значением последнего периода.  Очень важно отметить, что использовалось значение доходности, а не цена акции, поскольку цена – нестационарная. Доходность в расчетах данной КТС была в процентах. Она показывает – на сколько процентов изменилась цена акции по отношению к предыдущему периоду и в каком направлении.

Список моделей для активов приведен ниже. Модели выполняются 2 методами – скользящего окна и нарастающего окна. Часть моделей были построены обоими способами, некоторые модели – только скользящим окном. Модели для Газпрома:

Экспоненциальное сглаживание Holtwinters (тренд и сезонность);

ARIMA – AR(1) MA(1);

ARIMA – AR(3) MA(3);

Линейная модель с факторными переменными: нефть марки Brent, индекс ММВБ, индекс S&P 500, валютная пара USD-RUB;

Модель с факторными переменными с лагом 1: нефть марки Brent, индекс ММВБ, индекс S&P 500, валютная пара USD-RUB;

Модель с факторными переменными: нефть марки Brent, индекс ММВБ, индекс S&P 500, валютная пара USD-RUB, котировки Газпрома (за прошлый период);

Модель с факторными переменными с лагом 1: нефть марки Brent, индекс ММВБ, индекс S&P 500, валютная пара USD-RUB, котировки Газпрома (за прошлый период);

Модель с факторными переменными с лагом 1: нефть марки Brent, индекс ММВБ;

Модель с факторной переменной с лагом 1: нефть марки Brent;

Модель с использованием нейросетей, переменные: нефть марки Brent, индекс ММВБ;

Для других компаний схожие модели. Отличия, в основном, состоят только в выборе факторных переменных. При построении некоторых прогнозов с факторными переменными были построены авторегрессии по всем факторам.

Рассмотрим конкретный пример получения прогноза по одной модели. С помощью программного пакета R необходимо построить прогнозы скользящим окном для акций Газпрома на период с января по 20 мая 2013 года. Длина периода неделя или семь дней. Ретроспективный период с января 2010 по декабрь 2012 включительно. Модель – экспоненциальное сглаживание, тренд и сезонности учитываются. Тогда, список действий в R будет следующий:

Загрузить необходимые пакеты:

<-library(quantmod)

<-library(zoo)  

<-library(rusquant) 

…

Загрузить котировки акций компании, источник – финам (дополнительные данные – котировки за один период пред началом ретроспективного; это необходимо для того, чтобы перейти от цен к доходностям):

<-getSymbols("GAZP", src="Finam", from="2009-12-24", to="2013-05-20", period="week")

Перейти от цен акций к доходностям в %, для этого необходимо создать переменную с лагом и привести ее к необходимому временному периоду:

<-gazplag=lag(Cl(GAZP),1) – переменная с лагом

<-gazplag1=gazplag[-1,] – устраняем первый ряд данных, т.к. они на конец 2009 (а ретроспективный период с 2010) и у ячейки нет значения

<-gazprom=((Cl(GAZP)-gg1)/gg1)*100 – доходность в процентах на сегодня по отношению к предыдущему периоду

Создать временной ряд:

<-gazp.ts=ts(gazprom, freq=51) – временной ряд по доходности Газпрома, freq означает количество периодов в году

Создать цикл. Прогноз осуществляется на один период вперед. Прогнозный период начинается с января 2013 года. Начиная с этого момента до 20 мая 2013 года каждый период строится прогноз на следующий. Цикл выглядит следующим образом:

<-window = 154 – количество строк (значений) окна

<-n = NROW(gazprom)-window – количество кругов 

<-frcs2 = NULL

<-for (i in 1:n){

<-gz=gazprom[i:(i+window)] – ретроспективный период на момент прогноза

<-gazp.ts=ts(gz, freq=51) – временной ряд данного периода

<-gazp.hw=HoltWinters(gazp.ts) – экспоненциальное сглаживание

<-frcs2[i]=predict(gazp.hw,n.ahead=1) – прогноз 

<-}

<-frcs2  - прогнозные значения

Показателями модели являются R2, R2/S2 и результативность последнего прогноза. Но для экспоненциального сглаживания скорректированный R2 редко применяется, поскольку сложно определить количество уровней свободы для сглаживания. 





Таблица 1 



Прогнозные значения доходности акций Газпрома с использованием экспоненциального сглаживания





Также в качестве оценки модели был рассмотрен заменитель R2 – корреляция значений, полученных моделью, и фактических значений в квадрате. Данная оценка показывает  - какую часть наблюдений описывает модель. Для данной модели показатель был очень низкий, близкий к нулю на всех прогнозных периодах (подробнее можно посмотреть в приложении1). И как видно из таблицы 1, прогнозные значения сильно расходятся с фактическими . Данная модель не рекомендуется для построения прогнозов.

Подобная процедура повторяется для всех моделей. Для некоторых моделей были добавлены показатели эффективности. Например, для ARIMA моделей – MASE (mean absolute scaled error) и MAE (mean absolute error). Последний не может быть использован для сравнения моделей с разным количеством наблюдений. На основе этих показателей была выбрана лучшая ARIMA модель, которая после, наравне с другими моделями, была включена в лучшие прогнозы некоторых периодов.

Модели с факторными переменными требуют, чтобы все переменные имели одинаковое количество наблюдений. Именно поэтому, все котировки приведены к одинаковому виду: имеет одинаковое количество рядов и столбцов, все даты совпадают.



 Результаты моделей прогнозирования



Процедура выбора лучших моделей для формирования прогнозного значения состоит в том, чтобы на каждом шаге, т.е. на каждом прогнозном периоде, сравнить показатели всех моделей и выбрать лучшие. Например, для ОАО «Газпром» прогноз по всем моделям на 20 мая 2013 года представлен в таблице 2. Лучшие модели за данный период по Газпрому – ARIMA AR(3) MA(3) скользящим окном и линейная модель с факторными переменными: нефть, индекс ММВБ и S&P 500, валютная пара дол/руб. тоже скользящим окном.


                                                                                                          Таблица 2



Результаты моделей по прогнозу на 20 мая 2013 года







Чтобы получить окончательный прогноз доходности на 20 мая возьмем средневзвешенное значение этих двух прогнозов. Каждому из этих лучших прогнозов назначим вес – 0,5, поскольку каждый из них лучший по какому-то критерию оценки. Тогда финальное значение прогноза: -1,483%. Это означает, что по прогнозу Газпром потеряет 1,483% стоимости акции. Решением инвестора на 13 мая будет открыть шорт позицию по Газпрому.

Аналогичным образом были получены лучшие прогнозы за другие периоды. Прогнозы всех моделей в сравнении с фактическими значениям приведены на рисунке 4. С его помощью можно увидеть разброс прогнозов. Поскольку количество моделей 12 штук, коридор прогноза довольно большой. На рисунке 3 приведен график среднего значения всех прогнозов в сравнении с фактическими значениями. Из графика видно, что среднее значение доходности находится на уровне нуля (-0,46).  Исходя из этого и графика всех моделей, можно сделать вывод, что прогнозы моделей сильно отличаются и, зачастую, противоположны друг другу. Следовательно, следует аккуратно выбирать лучшие модели для окончательного прогноза. 







Рис. 3. Средний прогноз по всем моделям Газпрома



Рис. 4. Прогнозы по всем моделям Газпрома





Лучший прогноз для Газпрома выбирался по показателю R2 и точности прогноза модели за предыдущий период. В приложении 1 приведен выбор комбинации лучшей модели на всех прогнозных периодах. Итоговый прогноз выглядит следующим образом:




Таблица 3 



Прогноз комбинации лучших моделей по Газпрому







На графике в сравнении с фактическими значениями лучший прогноз сильно отличается. Это вызвано тем, что сильные изменения доходности сглаживались противоположными значениями разных моделей с высокими оценками. Поэтому дисперсия значений лучшего прогноза невысокая по сравнению с реальными значениями. Прогноз можно еще больше усреднить, взяв среднее между значениями прогнозов лучшей модели и средней модели. Возможно, модели с удачным прогнозом не были включены в лучший прогноз, тогда наложение средней модели на лучшую улучшит точность прогноза. На рисунке 5 приведен график лучшей модели,  на рисунке 6 – усредненная лучшая модели (средние значения между лучшим прогнозом и средним по всем моделям). В таблице 4 приведена разница прогнозных и фактических значений усредненной модели в сравнении с аналогичным показателем для лучшей модели. Как видно из таблицы, ошибка только увеличилась с усреднением прогноза. Тогда финальным прогнозом по Газпрому будет прогноз, построенный по комбинации лучших моделей.







Рис. 5. Лучший прогноз по Газпрому







Рис. 6. Усредненный лучший прогноз по Газпрому

Таблица 4

Сравнение усредненного лучшего и лучшего прогнозов







Таким же образом построены лучшие прогнозы по ОАО «Ростелеком», ОАО «Сбербанк России»  и ОАО «Аэрофлот». 




- ОАО «Сбербанк России»  





Таблица 5



Лучшие прогнозы по ОАО « Сбербанк России»









Рис. 7. Лучший прогноз по Сбербанку







Рис. 8. Средний прогноз по Сбербанку 




ОАО «Ростелеком»





Таблица 6



Лучшие прогнозы по ОАО «Ростелеком»











Рис. 9. Лучший прогноз по Ростелекому









Рис. 10. Средний прогноз по Ростелекому




ОАО «Аэрофлот»





Таблица 7



Лучшие прогнозы по ОАО «Аэрофлот»







Рис. 11. Лучший прогноз по Аэрофлоту







Рис. 12. Средний прогноз по Аэрофлоту





 Принятие решений



Для принятия решений инвестору необходимы прогнозные значения на следующий период по активу и его текущие котировки. Поскольку в предложенной КТС прогнозировалась доходность, инвестор может принимать решений основываясь на направленности доходности и ее значения, ведь доходность показывает на сколько процентов вырастет или упадет цена актива. При расчете прибыли, на основании которой принимается решение, необходимо учитывать все издержки, которые несет инвестор. К примеру, комиссии, плата за обслуживание счета и так далее. В конкретном случае, предложенном в данной работе, учитывались только комиссии, так как они привязаны к обороту, а, значит, на их величину можно скорректировать доходность. Скорректированная доходность и будет прибылью инвестора. В качестве ставки комиссии была взята ставка компании финам для тарифа «РРМ». Она составляет 0,035% от сделки. Для проведения одной операции с получением прибыли или убытка, необходимо провести две сделки: открыть и закрыть позицию. Поэтому комиссия будет удваиваться. Комиссия данного тарифа очень низкая, это вызвано  тем, что дивиденды в рамках данного портфеля не уплачиваются. Кроме того, торговлю по данному тарифа осуществляется через оффшорную компанию. У данного тарифа отсутствует порог минимальной комиссии. Именно этот факт и отсутствие дивидендов стали решающими при выборе тарифа. Ведь данная КТС не учитывает прибыль от дивидендов и все расчеты ведутся в процентах, т.е. при добавлении фиксированных выплат решения по бумаге могут меняться в зависимости от объема вложенных средств. Данный тариф позволяет рассчитать прибыльность для любой инвестируемой суммы.  Расходы по обслуживанию счета не учитывались при принятии решения, т.к. данные расходы являются издержками инвестиционной деятельности в целом и сумма выплат составляет всего 170 рублей в месяц. При расчете прибыльности портфеля в целом данные издержки будут учтены. Расчеты прогнозной прибыльности и принятия решения для Газпрома приведены в таблице 8.











Таблица 8



Принятие решения по акциям Газпрома







Исходя из сделок, приведенных в таблице 8, рассчитаем полученную инвестором прибыль. При расчете учитывается только решение о сделки и фактическое изменение, стартовый капитал – 100 денежных единиц или 100% первоначальных инвестиций. В каждую новую сделку он вкладывает все оставшиеся средства, т.е. все заработанные средства инвестор вкладывает в следующую сделку. В таблице 9 приведены результаты сделок по Газпрому, получена прибыль.



Таблица 9 



Результаты сделок по Газпрому







Из таблицы видно, что итоговая доходность за период с 7 января по 20 мая по акциям Газпрому составила 25,565%. Следовательно, можно сделать вывод, что лучший прогноз удачно угадывал направления движения котировок, хоть и абсолютная величина изменений не совпадала с реальными значениями. 

Итоговый прогноз по Газпрому с использованием КТС получился неточный, прогнозные значения сильно отличались от фактических. Но в данных условиях намного важнее предсказывать направление движения, чем величину этого движения, поскольку инвестор вкладывает все выделенные деньги в сделки вне зависимости от величины ожидаемых изменений. Сравним прибыльность по Газпрому и изменение индекса ММВБ за период с 7 января по 20 мая 2013 года. Результаты приведены в таблице 10. За данный период индекс ММВБ имел отрицательное изменение, он упал на 8,5%, в то время, как результативность КТС по Газпрому составила 25% прибыльности. За данный период в четыре с половиной месяца КТС обыграла рынок на 37% (отношение конечного портфеля по Газпрому и по индексу на одну и ту же сумму). 









Таблица 10



Сравнение результатов сделок по Газпрому и индекса ММВБ за период с 7 января по 20 мая 2013 года







Аналогичным образом посчитана прибыль для других компаний. Результаты приведены ниже:



ОАО «Сбербанк России»





Таблица11



Результаты сделок по ОАО «Сбербанк России»







ОАО «Ростелеком» 





Таблица12



Результаты сделок по Ростелекому







ОАО «Аэрофлот»





Таблица13



Результаты сделок по Аэрофлоту



	В результате, доходность по всем активам превысила изменение индекса ММВБ. В рамках данной работы, инвестор диверсифицирует риски, вкладывая в компании разных отраслей. Средства распределяются поровну. Тогда показателем доходности портфеля  будет среднее значение между доходностями по всем компаниям. На таблице 14 представлены доходности портфеля и всех компаний по отдельности в сравнении с индексом ММВБ.





Таблица14



Результаты Портфеля







Показатель доходности портфеля довольно высокий – он составил прирост в десять процентов за четыре с половиной месяца, в то время, как рынок имел нисходящее движение. 

Таким образом, предложенная КТС смогла обыграть рынок на представленном промежутке времени. С одной стороны, данная ситуация – случайное совпадение прогнозов и реальных котировок. С другой стороны, из всех предложенных моделей была создана лучшая модель, прогноз по которой оказался более точным, чем у остальных моделей. Из этого следует, что,  использование данного подхода к прогнозированию предоставляет более точные прогнозы, чем использование одной модели для построения прогнозов.

Заключение



Возможность предсказания ценовой динамики активов фондового рынка интересовала как академиков, так и участников рынка еще с середины прошлого века. Но ни одной доминантной теории на сегодняшний день нет. Поскольку считается, что в долгосрочном периоде рынок – эффективен, то решением является использования прогнозирующего моделирования на ограниченных участках времени. Это вызвано еще и тем, что, если модель находит неэффективность на рынке, то через некоторое время данная неэффективность будет известна большинству участников рынка, неэффективность исчезнет. Тогда, если рыночный агент желает всегда обыгрывать рынок, ему необходимо постоянно искать неэффективности на рынке, т.е. искать и подбирать различные методы моделирования и прогнозирования. Главными принципами являются постоянная переоценка параметров прогнозирующих моделей, переключение между моделями или комбинациями моделей, построение комбинированных моделей. Данная тема актуальна еще и потому, что финансовая активность в России, также как и общее количество вовлеченных в фондовый рынок людей, постоянно растет. Появляются новые брокерские компании, экономически активное население проявляет все больший интерес к бирже. Возникает спрос на торговых ботов и торговые системы. А из выводов, сделанных выше, более эффективно показывают себя торговые системы, использующие комбинации моделей, постоянно изменяющиеся. Комбинированная торговая система основывается именно на данных принципах. Весь этот процесс можно назвать как комбинированное  моделирование. 

Первая часть работы состояла в получении теоретических знаний о прогнозирующем моделировании, обоснования использования методик прогнозирования. В ней содержится доказательство возможности предсказуемости рынка, вытекающее из гипотезы адаптивных рынков, которая, в свою очередь, основывалась на ГЭР. В итоге, рынок всегда находится в движении, но его можно предсказать. Для этого необходимо использовать такое же подвижное моделирование: переключаться между моделями, изменять параметры моделей с течением времени, использовать комбинации лучших моделей и т.д. Тиммерман в своей работе “Economic forecasting” уделял особое внимание способу выбора лучших моделей и изменения ретроспективного периода с течением времени. Следует выделять несколько критериев оценке моделей. Поскольку эконометрические модели могут быть успешными, а в экономическом разрезе они могут быть менее эффективными, следует использовать не только эконометрические оценки моделей, как R2 или R2/S2, но и эффективность модели на последнем периоде.

Во второй части работы была создана комбинирования торговая система и протестирована на российской бирже. С помощью теоретических знаний и навыков, приведенных ранее, и программного пакета R, КТС была запущена и имела высокие результаты. Ей удалось опередить доходность от пассивного держания индекса ММВБ на предложенном периоде. Общий доход по портфелю составил более 10% за четыре с половиной месяца. Также было на практике показано, что модели с хорошими эконометрическими оценками могли иметь неточные прогнозы и уступать моделям с высокими экономическими оценками. В ходе проекта сравнивались комбинированные модели, переключающиеся между несколькими моделями, и одиночные модели. Эффективность и точность прогнозов, также как и прибыльность по держанию портфеля, исходя из прогнозов, была выше у комбинированных моделей.

Таким образом, использование комбинированного моделирования, экономических оценок и более гибкого моделирования, которые рассматривались в данной работе, является еще один шагом в изучении прогнозирующего моделирования и применении его на практике.






Список использованной литературы



Специальная литература

Рамзаева Е.П. Рынок ценных бумаг - составная часть финансового рынка // Экономические науки. - 2011.  № 77. С. 47-50.

Рудницкая А. Эти два процента и живут // Огонёк. - 2006.  № 51. 

Elliot G., Timmerman A. Economic Forecasting. // Journal of Economic Literature. - 2008. Vol. 6, № 1. P. 3-56.

Elliot G., Timmerman A. Elusive return predictability. // International Journal of Forecasting. - 2008. Issue 24. P. 1-18.

Lo А. Efficient Market Hypothesis. // The New Palgrave: a Dictionary of Economics, L. Blume, S. Durlauf, eds., 2nd Edition, Palgrave Macmillan Ltd.,  - 2007.

Lo А. Adaptive Market Hypothesis // the Journal of Portfolio Management. -2004. Issue 30. P. 15-26.

Samuelson P. Proof That Properly Anticipated Prices Fluctuate Randomly // Industrial Management Review – 1965, vol. 6, P. 41–9.

Электронный ресурсы

 / Информационный сайт по R [Эл. ресурс]. Режим доступа: 

 / Информационный сайт по R [Эл. ресурс]. Режим доступа: 

 / Информационный сайт по R [Эл. ресурс]. Режим доступа: 

 / Котировки, словарь [Эл. ресурс]. Режим доступа: 

 / Информационный сайт по R [Эл. ресурс]. Режим доступа: 

Moenetarism.ru / Определения [Эл. ресурс]. Режим доступа: 

 / Информационный сайт по R [Эл. ресурс]. Режим доступа: 

Personality-project.org / Информационный сайт по R [Эл. ресурс]. Режим доступа: 

 / Информационный сайт по R [Эл. ресурс]. Режим доступа: 

 / Форум по R [Эл. ресурс]. Режим доступа: 

 / Информационный сайт по R [Эл. ресурс]. Режим доступа: 

Statoek.wiso.uni-goettingen.de / Информационный сайт по R [Эл. ресурс]. Режим доступа: 

 / Форум по R [Эл. ресурс]. Режим доступа: 

Talkstats.com / Форум по R [Эл. ресурс]. Режим доступа: 

Campbell J. Y. Stock Returns and the Term Structure. Journal of Financial Economics, 1987: [Электронный ресурс] – Режим доступа: http://www.jstor.org/stable/pdfplus/2328190.pdf

Campbell J.Y., Lo A.W., Mackinlay A.C. The econometric of financial markets. The Economic journal, vol. 108, no. 448, May, 1997: [Электронный ресурс] – Режим доступа: http://www.jstor.org/stable/117373.

Chan N., On likelihood ratio tests for threshold autoregression, 1988: [Электронный ресурс] – Режим доступа:
http://www.jstor.org/pss/2345670

Fama E. Efficient Сapital Markets: a Review of Theory and Empirical Work. The journal of finance, vol. 25, no. 2, May 1970: [Электронный ресурс] – Режим доступа: http://www.jstor.org/stable/pdfplus/2325486.pdf

Fama E. Efficient Capital Markets: II. The journal of finance, vol. 46, no. 5, December 1991: [Электронный ресурс] – Режим доступа: http://www.jstor.org/stable/pdfplus/2328565.pdf

Fama E., French K.R. Business Conditions and Expected Returns on Stocks and Bonds. Journal of Financial Economics, 1980: [Электронный ресурс] – Режим доступа: http://www.jstor.org/stable/1833211.pdf

Fama E., French K.R.  Permanent and Temporary Components of Stock Prices. The journal of political economy, vol. 96, no. 2, April 1988: [Электронный ресурс] – Режим доступа: http://www.jstor.org/stable/pdfplus/1833108.pdf

Fama E., Schwert G.W. Stock Returns, Real Activity, Inflation and Money, 1981: [Электронный ресурс] – Режим доступа к ст.:  http://www.jstor.org/pss/1806180

Lo А. Adaptive Market Hypothesis // the Journal of Portfolio Management, 2004. Issue 30. P. 15-26.

Lo A.W. and A.C. MacKinlay. Data-snooping biases in tests of financial asset pricing models. Review of Financial Studies, March 1990: [Электронный ресурс] – Режим доступа: http://www.jstor.org/stable/pdfplus/266938.pdf

Mills D.Jr. . , Elsevier, vol. 76(3), August 2002: [Электронный ресурс] – Режим доступа: 
http://www.jstor.org/stable/pdfplus/55648791.pdf

Pesaran M.H., Timmermann A. A Recursive Modelling Approach to Predicting UK Stock Returns. Economic Journal, Royal Economic Society, vol. 110(460), January 2000: [Электронный ресурс] – Режим доступа: 
http://www.jstor.org/stable/pdfplus/2329350.pdf

Pesaran M.H., Timmermann A. Market Timing and Return Prediction Under Model Instability. Journal of Empirical Finance, Elsevier, vol. 9(5), December 2002: [Электронный ресурс] – Режим доступа: http://www.jstor.org/stable/pdfplus/2329356.pdf 

Pesaran M.H., Timmermann A. Predictability of Stock Returns: Robustness and Economic Significance. The journal of finance, vol. 50, no. 4, September 1995: [Электронный ресурс] – Режим доступа: 

Timmermann A. An Evaluation of the World Economic Outlook Forecasts. IMF Working Papers 06/59, International Monetary Fund, 2006: [Электронный ресурс] – Режим доступа: http://www.jstor.org/stable/pdfplus/8817522.pdf

Tushar S. Chande, Beyond Technical Analysis: How to Develop and Implement a Winning Trading System, p. 3, 1997








                                                                                                                      Приложение 1



Модели прогнозирования по ОАО «Газпром»

























































































































































































































































