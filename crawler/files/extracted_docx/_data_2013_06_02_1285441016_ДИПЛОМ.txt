Правительство Российской Федерации



Государственное образовательное бюджетное учреждение 

высшего профессионального образования



«Национальный исследовательский университет -
Высшая школа экономики»



Факультет мировой экономики и мировой политики

Кафедра международных валютно-финансовых отношений



ВЫПУСКНАЯ КВАЛИФИКАЦИОННАЯ РАБОТА



на тему: «Генерация функций плотности вероятности как решений дифференциального уравнения второго порядка при прогнозировании фондового рынка»







Студент группы № 463

Байбара Дмитрий Иванович



Руководитель ВКР

д.э.н., профессор 

Евстигнеев Владимир Рубенович



    











Москва,  2013









Вступление

Современный фундаментальный финансовый анализ овладел довольно серьезным и изощренный математическим аппаратом, сравнимым по своей сложности с инструментарием, используемым в сегодняшней физике. В финансовой науке нашли широкое применение математический анализ, теория вероятностей и дифференциальные уравнения, а также отдельные блоки математической статистики и эконометрики.

Темой данного исследования является генерирование функций плотности вероятности как решений дифференциального оператора второго порядка (в частности, уравнения Фоккера-Планка) для прогнозирования финансовых рынков. Актуальность такого рода исследования обусловлена его исключительно прикладным характером, заключающимся в разработке стратегии для торговли на фондовых рынках, в чем исследователь и видит основную цель работы. 

Объектом данного исследования выступает метод фундаментального анализа эволюции ценовых процессов на финансовых рынках с помощью дифференциальных уравнений второго порядка. В качестве предмета исследования был выбран дифференциальный оператор второго порядка в частных производных – уравнение Фоккера-Планка, на основании общего решения которого в данном исследовании строится прогноз курсовой стоимости обыкновенных акций компаний, входящих в индекс Доу-Джонса.

Данная работа содержит шесть основных глав, отражающих, в свою очередь, шесть основных задач исследования. В первой главе мы разберемся с физикалистскими истоками уравнения Фоккера-Планка, рассмотрим предпосылки, на которых оно строится, а также каким образом задает временную эволюцию функции плотности вероятности. В Главе II мы увидим, каким образом данный дифференциальный оператор второго порядка используется в контексте анализа финансовых рынков, а также получим ряд частных полиномиальных решений данного уравнения. В третьей главе нам предстоит рассмотреть методологию поиска общей весовой функции, а также процедуру ортонормировки частных полиномиальных решений методом моментов. Глава IV, в свою очередь, целиком посвящена различным методам поиска функции плотности вероятности до начала временной эволюции для формулирования «начального условия», используемого для нахождения полиномиальных весов. В пятой главе мы, используя результаты всех предыдущих разделов, построим общее решение уравнения Фоккера-Планка на каждый временной период. Наконец, в Главе VI мы на основании полученного ряда общих решений построим оценки доходности каждой из бумаг, входящих в нашу выборку, и разработаем эффективное правило для торговли на фондовом рынке, позаботившись о введении необходимых модификаций для снижения волатильности и повышения доходности торговой стратегии. 

Для обработки данных и формализации торговых алгоритмов в ходе данного исследования использовался математический пакет Mathcad 15. Все формализованные расчетные документы, а также база данных рыночного исследования содержатся в приложениях 1 – 7.















I. Физикалистская природа уравнения Фоккера-Планка

I.1. Детерминистское дифференциальное уравнение

Впервые уравнение Фоккера-Планка было выведено нидерландским физиком и музыкантом Адрианом Фоккером и немецким физиком-теоретиком Максом Планком для описания Броуновского движения частиц. По своей природе, оно лишь являлось конкретизацией прямого уравнения диффузии Колмогорова, названного в честь советского математика Андрея Николаевича Колмогорова, который впервые представил его в своей работе «Об аналитических методах в теории вероятностей» в 1931 г.

В теоретической физике уравнение Фоккера-Планка используется для описания временной эволюции функции плотности вероятности скорости элементарной частицы (или любого другого сходного процесса). Для понимания природы данного уравнения в первую очередь следует рассмотреть феномен Броуновского движения в физикалистском понимании. 

Пусть элементарная частица имеет массу m и характеризуется скоростью v. Если поместить данную частицу в жидкость, на нее начнет действовать сила трения (или демпфирующая сила) Fc, определяемая по закону Стокса как:

,

где  r – радиус элементарной частицы,

       η – динамическая вязкость жидкости.

В простейшем случае данное выражение для силы трения можно переписать в виде:



В отсутствии других сил, действующих на данную частицу, мы можем записать ее уравнение движения при условии того, что мы помним второй закон Ньютона:

,



где  a – ускорение тела,

       F – сумма действующих на данное физическое тело сил.

Таким образом, уравнение движения элементарной частицы, помещенной в жидкость, можно вывести из второго закона Ньютона в следующем виде:



или

,

где .

Получив уравнение движения элементарной частицы, в дальнейший анализ введем понятие времени релаксации τ. Согласно принципу Анри Ле Шателье, если физическая система выходит из состояния равновесия, возникают силы, пытающиеся вернуть данную систему к балансу. В нашем случае данный принцип находит следующую интерпретацию: если в состоянии равновесия скорость элементарной частицы v принимает значение vo, причем отклонение от равновесия мало (|v-vo|<<vo), то кинетическое уравнение для скорости можно записать в виде:

,



где τ – время релаксации (т.е. период времени, за который амплитудное     значение возмущения в выведенной из равновесия физической системе уменьшается в e раз).

Решим данное дифференциальное уравнение относительно v:



<=>



<=>



<=>

                             <=>           <=>      

Таким образом мы доказали, что полученное уравнение движения элементарной частицы – детерминистское уравнение, так как скорость частицы v в любой момент времени t однозначно определяется с помощью своего начального значения vo.

I.2. Стохастическое дифференциальное уравнение

В физике считается, что детерминистское дифференциальное уравнение движения элементарной частицы, приведенное выше, действительно тогда и только тогда, когда масса данной частицы достаточно велика для того чтобы не учитывать изменение скорости данной частицы из-за термических колебаний. Таким образом, масса «малой» элементарной частицы не может быть корректно описана данным дифференциальным уравнением.

Что же касается частиц, размеры которых достаточно велики для пренебрежения термическими колебаниями, ожидается, что детерминистское уравнение для них действительно. Однако в целях соответствия термальной энергии элементарной частицы действительности, приведенное выше уравнение нуждается в дополнении. Мы вынуждены добавить силу колебания Ff(t) в правую часть детерминистского дифференциального уравнения, таким образом, что результирующая сила, действующая на элементарную частицу, будет выглядеть как:





Здесь сила колебания Ff(t) будет являться стохастической (или случайной) силой, свойства которой могут быть оценены только с помощью средних значений. 

Так почему же возникает стохастическая сила Ff(t)? Если бы мы взялись за решение данной задачи в явном виде, нам пришлось бы решить уравнения движения для каждой молекулы жидкости, а также для малой элементарной частицы. В этом случае, никакой стохастической силы бы не возникло. Однако в виду того, что количество молекул в жидкости будет числом порядка 1023, мы не можем решить данную задачу стандартным способом. Более того, мы также не знаем и начальных значений скорости всех молекул жидкости. Поэтому мы вводим понятие стохастической силы Ff(t), чтобы отталкиваться от средних значений данной величины для всей совокупности.

Таким образом, стохастическое дифференциальное уравнение движения элементарной частицы запишется в виде:

,

где  - сила колебания на единицу массы (сила Ланжевена).

I.3. Уравнение движения функции плотности распределения

Сила Ланжевена Γ(t), как и положено любой стохастической величине, принимает различные значения в разных «системах» совокупности. Это, в свою очередь, обуславливает тот факт, что скорость элементарной частицы v также станет стохастической случайной величиной. 

В связи с этим, мы можем задаться вопросом о вероятности того, что скорость v окажется в интервале (v;v+dv). Отметим также, что в этом случае имеется в виду, что найти вероятность попадания значения скорости в столь малый интервал равносильно нахождению вероятности принятия переменной v конкретного значения. 

В силу того, что скорость v – непрерывная переменная, мы можем говорить о ее функции плотности вероятности U(v). Таким образом, произведение значения длины интервала (v;v+dv) на функцию плотности вероятности для скорости элементарной частицы будет характеризовать вероятность нахождения частицы в данном интервале. Функция плотности распределения также будет зависеть от времени t.

Из определения понятия переходной вероятности следует, что плотности вероятности в моменты t и t+τ (U(v,t) и U(v,t+τ) соответственно) связаны между собой с помощью τ≥0. Применив прямое или обратное разложение Крамера одним из предлагаемых в популярной литературе способов, мы получим уравнение движения для функции плотности вероятности W(v,t), которое в простейшем случае будет выглядеть как:



Полученное уравнение – одно из простейших уравнений семейства Фоккера-Планка. Решениями данного уравнения с учетом адекватных граничных условий будут являться функции плотности вероятности  U(v,t), описывающие вероятность для скорости принять конкретное значение в любой момент в будущем. В свою очередь, получив функцию U(v,t), мы можем с помощью интегрирования получить любое усредненное значение скорости:



,

где h(v) – произвольная функция.

	Инструментарий, используемый в физике, нашел свое применение и в современном финансовом анализе. Следующая глава данного исследования посвящена тому, какую роль дифференциальные операторы второго порядка играют в финансовой науке.

















II. Поиск частных полиномиальных решений уравнения Фоккера-Планка в контексте анализа финансовых рынков

II.1. Общий вид уравнения Фоккера-Планка в финансовом анализе	

Разобравшись в физикалистских истоках уравнения Фоккера-Планка, мы поняли, что, по своей природе, оно является уравнением движения функции плотности вероятности. Иными словами, данное уравнение представляет собой дифференциальный оператор, задающий временную эволюцию функции плотности. Каким же образом мы будем его использовать в контексте анализа финансовых рынков?

Следует еще раз напомнить, что современный финансовый анализ перенял у физики множество инструментов из различных областей высшей математики. Среди них – блоки линейной алгебры, теории вероятностей, дифференциальных уравнений и математического анализа. Адаптировано под нужды финансовых аналитиков было и уравнение Фоккера-Планка, являющееся дифференциальным оператором второго порядка в частных производных.

Напомним, что в предыдущей главе рассматривалась функция плотности вероятности U, зависящая от двух аргументов: v – скорости элементарной частицы и t – физического времени. Однако в отличие от физика, анализирующего с помощью дифференциальных уравнений скорости элементарных частиц или любые другие сходные по природе феномены, финансиста интересует финансовая переменная (в данном исследовании мы обозначим ее за х и будем рассматривать как доходность обыкновенных акций). 

Итак, уравнение Фоккера-Планка нам необходимо как дифференциальный оператор, задающий временную эволюцию функции плотности распределения доходности обыкновенных акций U(x,t). В своем стандартном виде данный оператор будет выглядеть как дифференциальное уравнение второго порядка в частных производных:

,

где  μ(x,t) – математическое ожидание случайного смещения доходности обыкновенных акций х,

            σ(x,t) – дисперсия вокруг данного смещения.

Параметры μ(x,t) и σ(x,t) также принято называть функциями смещения и диффузии соответственно.

Как уже было сказано выше, по своей природе уравнение Фоккера-Планка является уравнением движения функции плотности вероятности U(x,t). Изменение же самой финансовой координаты x описывается следующим стохастическим дифференциальным уравнением:



Данное уравнение является описанием процесса Ито в единственном измерении. Здесь переменной Bt обозначено стандартное броуновское движение (также известное как винеровский процесс).

Стандартным в финансовом анализе является подход, при котором для удобства анализа функция плотности вероятности U(x,t), зависящая от двух аргументов, раскладывается на X(x) и T(t). Это называется методом разделения переменных, так часто используемым в математической физике. В результате данного преобразования, исходное уравнение принимает следующий вид:



Обратим внимание на то, что теперь функции мгновенного смещения μ(x) и диффузии σ(x) зависят лишь от финансовой переменной x.

Итак, мы рассмотрели общий вид дифференциального оператора, задающего временную эволюцию функции плотности вероятности U(x,t). Ее мы, в свою очередь, для удобства дальнейшего анализа разложили на X(x) и T(t). Дальнейшее решение уравнения Фоккера-Планка предполагает разделение исходного дифференциального оператора на две части, каждая из которых будет являться обыкновенным дифференциальным уравнением. В свою очередь, произведение решений данных ОДУ и будет представлять собой решение исходной задачи. 

Стоит отметить, что общее решение в виде функции плотности вероятности U(x,t) даст нам мощный инструмент для анализа финансовых рынков. К примеру, мы сможем строить торговые правила на основании оценок, полученных с помощью решения уравнения Фоккера-Планка на различные инвестиционные горизонты.

II.2. Приведение исходного уравнения к виду двух ОДУ. Решение ОДУ для физического времени

Разделив переменные в исходном уравнении Фоккера-Планка, мы переходим к приведению исходного дифференциального оператора к виду двух обыкновенных дифференциальных уравнений, каждое из которых будет иметь вид:

,

где y=f(x).

Как мы видим, интегрирование в каждом ОДУ по определению производится лишь по одной переменной. 

Итак, после проведения ряда элементарных операций, таких как вынесение множителей за знак дифференциала и деление обеих частей уравнения на X(x) и T(t), исходное уравнение Фоккера-Планка принимает вид:



Как мы видим, данный вид действительно представляет собой два ОДУ: левая часть зависит только от финансовой переменной x, а правая – только от физического времени t. Дальнейшая методика решения такого вида дифференциальных уравнений предполагает приравнивание каждого ОДУ к (-λ), которое в дальнейшем мы будем называть собственным значением оператора, а затем рассмотрение каждого ОДУ в отдельности и последующее нахождение общего решения уравнения Фоккера-Планка в виде произведения частных решений каждого ОДУ. 

Для начала рассмотрим обыкновенное дифференциальное уравнение, зависящее от физического времени t:



По своему виду, это простейшее дифференциальное уравнение первого порядка. Методология его решения состоит в элементарном разделении переменных с последующим интегрированием:



<=>



<=>

<=>









Здесь C и L – некоторые константы.

Решив данное дифференциальное уравнение, мы получили одну из двух компонент решения исходного уравнения Фоккера-Планка, необходимых для нахождения общего решения:





Далее нам предстоит решить ОДУ, зависящее от финансовой переменной x.

II.3. Решение ОДУ для финансовой переменной. Нахождение частных полиномиальных решений уравнения Фоккера-Планка

По своему виду, ОДУ для финансовой переменной x является обыкновенным дифференциальным уравнением второго порядка:



Данный тип дифференциальных уравнений называется уравнениями Штурма-Лиувилля. После домножения обеих частей уравнения на X(x), приведения подобных слагаемых и перенесения λ в левую часть, приведенное выше дифференциальное уравнение принимает более удобную форму:



Итак, в результате ряда элементарных операций, мы сгруппировали слагаемые данного однородного дифференциального уравнения. Дальнейшее решение предполагает параметризацию функций мгновенного смещения μ(x) и диффузии σ(x). К примеру, рассмотрим следующую спецификацию:

,

,

где m – среднее смещение финансовой координаты (доходности) на скользящем периоде,

       s – среднеквадратическое отклонение доходности, измеренное на том же скользящем векторе.

Принятие данной спецификации позволяет нам преобразовать коэффициенты при сгруппированных слагаемых как:

,



В результате преобразований уравнение Штурма-Лиувилля для финансовой переменной x будет выглядеть следующим образом:



Одним способов решения такого рода дифференциальных уравнений второго порядка является разложение по полиномам Родрига. Для этого данное приведенное выше уравнение следует представить в операторном виде. С этой целью целесообразно, во-первых, выделить собственное значения λ в обособленный параметр при X(x). В этой связи разделим обе части уравнения на s2x2: 





… и введем следующую замену:

,





Также необходим следующий ряд замен:





                                   

                                            



В результате чего мы приходим к операторному виду уравнения Штурма-Лиувилля:



Докажем эквивалентность стандартной и операторной форм записи уравнения Фоккера-Планка. Для этого в операторный вид вместо R(x) и W(x) подставим выражения, зависящие от параметризующих функций m и s: 





	Мы видим, что если разделить каждую часть полученного выражения на , то получится в точности стандартная форма записи уравнения Штурма-Лиувилля, что и требовалось доказать.

Убедившись в эквивалентности стандартной и операторной форм записи дифференциального уравнения для финансовой переменной x, разберемся с тем, как же решать такого рода уравнения.

Удобство и пафос операторной формы записи уравнения Штурма-Лиувилля состоят в том, что его решения легко находятся по формуле Родрига. Причем по способу Родрига можно сразу выписать как частные полиномиальные решения дифференциального уравнения, так и соответствующие им собственные значения α (а следовательно и λ):

,

,

,

где  n=1,2,… – порядок полиномиального решения,

       N – константа, зависящая от порядка полинома n.

Таким образом, по формуле Родрига мы нашли ряд частных полиномиальных решений уравнения Штурма-Лиувилля и соответствующие им собственные значения. Проверим корректность полученного результата: при подстановке полученных полиномов в комбинации с собственными значениями в левую часть уравнения Штурма-Лиувилля, она должна обращаться в нуль. К примеру, выполним проверку для частого полиномиального решения третьего порядка и соответствующего ему собственного значения:











Как мы видим, частное решение найдено корректно. Проверка для полиномиальных решений и собственных значений других порядков, а также для операторной формы записи также приводит к положительному результату. 

Таким образом, мы нашли ряд частных полиномиальных решений для обыкновенного дифференциального уравнения для финансовой переменной x и доказали их корректность. Что касается решений исходной задачи (уравнения Фоккера-Планка, представлявшего собой дифференциальный оператор второго порядка в частных производных), они находятся перемножением решений двух ОДУ:



Заметим, что в данной форме записи каждое найденное частное решение зависит от n – своего порядка. К примеру, после ряда упрощений решение уравнения Штурма-Лиувилля с использованием полиномов и собственных значений второго порядка будет выглядеть как:



Корректность данного решения проверим, подставив в исходное уравнение Фоккера-Планка:



Не стоит забывать, что найденный ряд частных полиномиальных решений p(x,t,n) – это не то же самое, что общее решение уравнения Фоккера-Планка U(x,t), о поиске которого речь пойдет в следующей главе. 



















III. Поиск общей весовой функции и ортонормировка частных полиномиальных решений уравнения Фоккера-Планка

III.1. Методология поиска общего решения в контексте анализа рынка обыкновенных акций

В прошлой главе была описана методология получения частных полиномиальных решений уравнения Фоккера-Планка и соответствующих им собственных значений. Для того чтобы в последующем анализе было удобно отталкиваться от полученного результата, в вектор u(x) присвоим шесть первых частных полиномиальных решений (с нулевого по пятый порядок):



В вектора α и λ присвоим найденные собственные значения, соответствующие данным полиномам.

На базе полученных в предыдущей главе результатов нам предстоит найти общее решение уравнения Фоккера-Планка, которое даст нам возможность составления прогнозных оценок. 

Получение общего решения из частных полиномиальных происходит в соответствии с принципом линейной суперпозиции. Идея состоит в том, что линейная комбинация независимых частных решений уравнения Фоккера-Планка p(x,t,n) будет представлять собой общее решение:

,

где сn – произвольные постоянные, т.е. веса, соответствующие каждому частному полиномиальному решению в отдельности.

Иными словами, на данном этапе задача поиска общего решения сводится к поиску весов для каждого полинома. Однако методология поиска данных весов cn предполагает решение большого количества предварительных задач:



где  a и b – некоторые константы, задающие пределы интегрирования,

       W(x) – весовая функция,

       q(x) – начальное условие, т.е. функция плотности распределения до начала эволюции (в момент t=0).

Таким образом, для нахождения весов для каждого полинома, нам предварительно следует задаться поиском неизвестных весовой функции W(x) и начального условия q(x).

На этом этапе следует еще раз подчеркнуть разницу между весовой функцией W(x) и весами cn, соответствующими частным полиномиальным решениям. Весовая функция W(x) является общей для всех полиномиальных решений уравнения Штурма-Лиувилля и служит лишь базой для нахождения весов cn.

III.2. Поиск общей весовой функции

Итак, рассмотрим методологию нахождения весовой функции W(x). Первый (и самый простой) способ нахождения символьного выражения для весовой функции заключается в простом делении R(x) на Q(x):



Второй способ немного сложнее и заключается в использовании операторной формы записи уравнения Штурма-Лиувилля. Заменим R(x) на W(x)*Q(x), а саму весовую функцию W(x) – на неизвестную G(x):

  --->



--->  

Чтобы G(x) удовлетворяла условиям решения, полученное выражение должно равняться нулю. Для этого при любом x≠0 и при m≠2s2 необходимо равенство нулю одного из двух выражений:



или









Тонкий момент заключается в том, что выражение, зависящее от G(x), одинаково для полиномиальных решений всех порядков, а вот второе выражение меняется в зависимости от порядка подставленных в операторную форму полиномов и собственных значений. Иными словами, мы вынуждены требовать либо равенства нулю выражения, зависящего от G(x), либо, строго говоря, бесконечного ряда полиномов, что значительно затруднит нашу задачу в будущем. В связи с этим, для нахождения весовой функции воспользуемся условием, содержащим G(x) и приведем для него подобные слагаемые:



Как мы видим, это обыкновенное дифференциальное уравнение первого порядка. Решим его, разделив переменные:

   

<=>



<=>

<=>







Константу мы можем найти, ограничив область определения x (в нашем  нашем случае – доходности обыкновенных акций), к примеру, отрезком [0;1]:



<=>



<=>

<=>



 



Таким образом мы нашли весовую функцию G(x) с точностью до константы:



Сравнивая весовые функции W(x) и G(x), найденные разными способами, стоит признать, что по своему виду они чрезвычайно похожи. Однако при поиске W(x) мы не были вынуждены принимать нереалистичных предпосылок об области определения доходности x. Поэтому в последующем анализе в качестве весовой будет использована функция W(x).

III.3. Необходимость проведения процедуры ортонормировки частных полиномиальных решений

 Работать с частными полиномиальными решениями уравнения Штурма-Лиувилля в сыром виде очень неудобно по ряду причин: во-первых, это значительно затрудняет расчеты и, во-вторых, работая в ортонормированном базисе, для эффективного представления линейного пространства нам понадобится существенно меньшее количество базисных полиномов.

Ортогональным называется базис, состоящий из ортогональных векторов (или функций, если говорить о непрерывном пространстве). Ортогональными с весовой функцией W(x) на отрезке [a; b] называются функции f(x)i, такие что:



Иными словами, базис, наилучшим образом представляющий векторное пространство, – это ортонормированный базис. Он позволяет наиболее просто найти коэффициенты, необходимые для отображения любого другого вектора a в виде комбинации базисных векторов a1…an: 



Получив ряд частных полиномиальных решений уравнения Штурма-Лиувилля по формуле Родрига, мы получили ряд полиномов, ортогональных на всей действительной числовой оси (-∞; +∞) с весовой функцией W(x). Однако в последующем анализе нам будет необходим ряд полиномов, ортогональных с данной весовой функцией на ограниченной области определения [a; b], что обуславливает необходимость проведения процедуры ортогонализации (и последующей ортонормировки). 

Два самых распространенных способа проведения ортонормировки – метод моментов Гамбургера-Ганкеля и метод ортонормировки по Граму-Шмидту. Первый метод основан на использовании матриц Гамбургера и Ганкеля, построенных на моментах весовой функции W(x). Второй метод представляет собой немного более громоздкую процедуру, однако применим даже в тех случаях, когда весовая функция нам неизвестна. 

В контекст данного исследования вписываются оба метода, однако, учитывая тот факт, что в предыдущих разделах мы получили выражение для весовой функции, проще всего будет воспользоваться гораздо менее громоздким методом ортонормировки по Гамбургеру-Ганкелю.

III.4. Ортонормировка полиномиальных решений методом моментов

Получение весовой функции W(x) в разделе III.2  дает нам возможность провести ортонормировку методом моментов с использованием матриц Гамбургера и Ганкеля.

Для начала рассчитаем центральные моменты весовой функции:



На их основании можно построить матрицу имени Ганса Людвига Гамбургера:

,

где υn – центральный момент весовой функции W(x) n–ого порядка.

Что же касается матриц имени Германа Ганкеля, их также можно построить из центральных моментов:



Получив моменты весовой функции и построив на их основе матрицы Гамбургера и Ганкеля, проведем процесс ортонормировки для полинома порядка n по следующему сценарию: 

,

где  – определитель матрицы А размерности n x n,

        N – некая константа, которую мы для простоты принимаем равной единице.

Таким образом, мы получаем бесконечную последовательность ортонормированных с весовой функцией W(x) на отрезке [a; b] полиномов.

































IV. Различные способы нахождения функции плотности до начала временной эволюции

IV.1. Методология преобразования с помощью оператора Перрона-Фробениуса нормальной плотности вероятности

В предыдущих главах мы рассмотрели методологию получения ряда ортонормированных полиномов и весовой функции. Теперь для расчета полиномиальных весов необходимо вывести начальное условие (т.е. функцию плотности вероятности до начала ее эволюции во времени). 

На данную роль подошла бы любая непрерывная функция плотности, у которой интеграл на той же области определения [a; b] равнялся бы единице. К примеру, мы могли бы воспользоваться функцией плотности нормального распределения, преобразованной с помощью оператора Перрона-Фробениуса таким образом, чтобы она замыкалась на интервале [a; b]. Рассмотрим данный способ подробнее.

Оператор Перрона-Фробениуса по сути представляет собой дифференциальное уравнение первого порядка, связывающее зависимость функции от ее аргумента с функциями плотности вероятности данного аргумента и его функции. В общем виде данный дифференциальный оператор записывается как:

,



где  – выражение, задающее зависимость функции y от аргумента x,

p(x) – функция плотности вероятности аргумента,

q(x) – функция плотности вероятности функции.

Таким образом, с помощью оператора Перрона-Фробениуса мы, зная, к примеру, функцию плотности вероятности аргумента и зависимость функции от аргумента, можем найти функцию плотности вероятности для самой функции.

Рассмотрим функцию плотности вероятности нормального распределения:

,

где μ – математическое ожидание аргумента y, 

      σ  - дисперсия аргумента.

Рассмотрев данные о котировках обыкновенных акций любой компании, входящей в индекс Доу-Джонса на 2013 год, мы можем убедиться, что эмпирическая дневная доходность данных ценных бумаг никогда не выходила за границы интервала [-1;1]. Поэтому, приняв вполне реалистичную предпосылку о данной области определения доходности, зададимся вопросом о подходящей в данном контексте функции перехода, которая будет отражать всю действительную числовую ось на отрезок [-1;1].

На эту роль безупречно подходит тригонометрическая функция sin(y) с нужной нам областью значений: [-1;1].  Таким образом, зная функцию плотности вероятности аргумента и зависимость аргумента от функции,  запишем оператор Перрона-Фробениуса следующим образом:

,





где   => .

Решив данное уравнение относительно q(y), получаем:



Заменив y на arcsin(x) и проведя ряд элементарных операций по упрощению, получим итоговую функцию плотности вероятности:





Проведя проверку, мы можем убедиться в том, что интеграл от полученной функции плотности вероятности на необходимой нам области определения действительно равен единице: .

Таким образом, мы получили начальное условие, которое мы можем использовать как функцию плотности вероятности до начала временной эволюции. 

Хотя данная операция значительно упрощает ход решения, в результате мы вынуждены ограничиваться лишь эволюцией нормальной плотности от периода к периоду. 

IV.2. Методология составления функционала при решении задачи вариационного исчисления

Чтобы избежать необходимости принятия ограничивающих предпосылок, для нахождения начального условия решим задачу вариационного исчисления. Оценив параметры по эмпирическим данным о доходности обыкновенных акций на скользящем периоде, мы надеемся получить функцию плотности вероятности, эволюционирующую от периода к периоду и наиболее точно описывающую эмпирическое распределение доходности.

Решение вариационной задачи всегда начинается с составления функционала, в который входят сама рассматриваемая переменная (в нашем случае – доходность обыкновенных акций), ее функция распределения, функция плотности вероятности как первая производная функции распределения, а также центральные моменты рассматриваемой функции плотности вероятности:

,

 где  – функция распределения вероятности для финансовой переменной x,

           δ=f(x) – функция плотности вероятности для финансовой переменной x, 

           μ, σ, η, θ – первый, второй, третий и четвертый центральные моменты функции плотности вероятности соответственно.

Слагаемое δ*ln(δ) составляет основу информационной энтропии по Клоду Шеннону: 





Считается, что ln(δ(xi)) – это количество информации, получаемое от i-ого сообщения. Причем в зависимости от единиц измерения, основанием логарифма могут служить различные константы (к примеру, вводя понятие информационной энтропии, сам Клод Шеннон использовал двоичное основание). Минус же перед знаком интеграла символизирует то, что неопределенность уменьшается с каждым следующим сообщением xi.

Далее в функционал включаются центральные моменты распределения, которые исследователь счел значимыми в данном контексте. В данном случае, мы посчитали необходимым оценить первые четыре центральных момента, которые дают представление о таких характеристиках распределения, как математическое ожидание, стандартное отклонение, асимметрия и эксцесс. 

IV.3. Уравнение Эйлера-Лагранжа и его решение

Решая задачу вариационного исчисления, мы задаемся вопросом: если существует непрерывная, дважды дифференцируемая функция распределения вероятности y(x), минимизирующая интеграл от функционала:

,

то какому дифференциальному уравнению удовлетворяет y(x)?

Ответом на этот вопрос будет дифференциальный оператор второго порядка в частных производных – уравнение Эйлера-Лагранжа, которое в общем виде для y(x) второго порядка имеет вид:

,

где за ε обозначена  – вторая производная функции распределения y(x) по финансовой переменной.

Из данного дифференциального уравнения нам интересно найти функцию плотности вероятности δ(x), поэтому будем решать уравнение относительно нее.

После проведения операций дифференцирования уравнение Эйлера-Лагранжа упрощается до следующего вида (ε распишем в виде производной функции плотности вероятности):



Разделим переменные и решим данное дифференциальное уравнение первого порядка относительно δ(x):



<=>



                <=>

<=>







Таким образом, мы нашли решение уравнения Эйлера-Лагранжа в виде функции плотности вероятности q(x), зависящей от константы C, а также центральных моментов различных порядков: μ, σ, η, θ.

IV.4. Оценка параметров распределения на скользящем векторе для формулирования эволюционирующего во времени начального условия

После того как мы нашли символьное выражение для начального условия (функции плотности вероятности до начала временной эволюции), мы можем попытаться оценить ее параметры на скользящем периоде, апеллируя к эквивалентности символьной и численной оценок центральных моментов.

Символьно моменты функции плотности оценим как:

,

где переменная k будет отвечать за порядок момента.

Здесь мы обнаруживаем тонкий момент: вид функции плотности вероятности q(x) в состав которой входит экспонента в отрицательной степени, обуславливает невозможность взятия от нее определенного интеграла. Поэтому перед вычислением моментов мы вынуждены разложить ее в ряд Маклорена. Для этого степень экспоненты обозначим за новую функцию φ(…):



и представим функцию плотности q(x) в виде полиномиального ряда, ограничившись шестью полиномами:



Таким образом, моменты функции плотности q(x) можно представить как:



Что касается численных оценок центральных моментов распределения, их, основываясь на эмпирических данных о доходности обыкновенных акций, мы найдем следующим образом:

,

где τ – номер периода,

      ρi,j – доходность бумаги в периоде i для компании j,

      p – длина скользящего периода.

Для того чтобы получить функцию плотности вероятности, эволюционирующую от периода к периоду, составим следующую систему уравнений, приравняв символьные оценки центральных моментов к численным:

















Так как мы хотим найти пять неизвестных параметров распределения, включая константу С, для их однозначного определения необходимо и достаточно пяти уравнений, записанных в систему. Также потребуем равенства площади под кривой функции плотности единице на отрезке [a; b]:



Введя ряд начальных приближений для неизвестных параметров, получим решение описанной выше системы уравнений в виде вектора Ψ(τ,j), в котором для каждого периода τ для каждой компании j будут содержаться данные о значениях параметров в следующем виде:



Общее решение вариационной задачи запишем в виде суммы компонент полиномиального ряда с численно найденными значениями параметров:

























V. Получение общего решения уравнения Фоккера-Планка

V.1. Расчет полиномиальных весов с помощью формул численного интегрирования

	Рассмотрев в предыдущих главах методологию получения ряда частных полиномиальных решений уравнения Фоккера-Планка и соответствующих им собственных значений, а также процедуры ортонормировки, получения весовой функции и начального условия, мы готовы перейти к расчету полиномиальных весов. 

В общем виде для получения полиномиальных весов нам придется перемножить под знаком интеграла само частное полиномиальное решение на весовую функцию, а также на начальное условие:



Таким образом мы получаем веса для каждого частного полиномиального решения на каждый период τ, для каждой j-ой компании. Однако здесь существует некоторая сложность вычислительного характера: данная операция связана со взятием определенного интеграла от сложной функции. Как известно, у математических пакетов (таких как, к примеру,  Mathcad 15) на этом этапе возникает масса сложностей.

В связи с этим, нам приходится прибегать к таким приемам, как вычисление определенных интегралов с помощью формул численного интегрирования. Идея метода состоит в том, что для любой непрерывной функции f(x):



Данная формула известна как «формула прямоугольников» или «формула средних». 

Ведь, действительно, как видно из Рис.1, площадь криволинейной трапеции можно заменить площадью прямоугольника. Погрешность данной формулы, соответственно, составляет:



Избавиться от знака интеграла можно с помощью разложения функции R в ряд относительно середины отрезка. В этом случае выражение для нее принимает вид:



Как не сложно догадаться, для повышения точности вычислений следует ввести сетку a = x0 < x1 < … < xn = b с достаточно мелким шагом. Тогда обобщенная формула прямоугольников предстает в виде (с учетом остаточного члена R):



Овладев данным инструментом, для вычисления полиномиальных весов введем функцию f(x,τ,j), такую, что:





Тогда при заданной достаточно мелкой сетке расчет полиномиальных весов сведется к следующей операции:



Таким образом, мы численно рассчитали веса, соответствующие каждому частному полиномиальному решению на каждый период τ, для каждой j-ой компании.

V.2. Методология получения общего решения уравнения Фоккера-Планка для каждого периода и каждой компании

На данном этапе мы располагаем всем необходимым для получения общего решения уравнения Фоккера-Планка: частными полиномиальными решениями, соответствующими им собственными значениями, а также численно рассчитанными весами.

Напомним, что в главе III.4 данного исследования мы проводили процедуру ортонормировки частных полиномиальных решений методом моментов с целью получения ортонормированного базиса для наилучшего и наиболее эффективного представления линейного пространства. В связи с этим, на данном этапе мы вправе считать, что шести ортонормированных полиномов вполне достаточно для представления общего решения уравнения Фоккера-Планка с малой погрешностью:



Получение общего решения U(x,τ,j) уравнения Фоккера-Планка предоставляет мощный инструмент прогнозирования ценового процесса на финансовых рынках. В частности, с помощью него мы можем получить оценку стоимости обыкновенных акций любой j-ой компании из нашей выборки на сколь угодно далекий инвестиционный горизонт.





























VI. Составление прогноза курсовой стоимости обыкновенных акций, входящих в индекс Доу-Джонса на основании общего решения уравнения Фоккера-Планка

VI.1. База данных рыночного исследования

	Актуальность любого исследования, прежде всего, основывается на актуальности данных, на которых оно строится. В данной работе мы используем базу данных “Data 2012-2013”, в которой содержится информация о котировках обыкновенных акций десяти компаний, входящих в индекс Доу-Джонса. Также в данной базе содержится информация о значениях самого индекса DJIA за период 2 июня 2012 – 13 мая 2013.

	База организована таким образом, чтобы математическому пакету Mathcad 15, использовавшемуся по ходу всего исследования, было удобно с ней работать. В частности, в данной базе данных уже рассчитаны значения среднего смещения финансовой координаты на скользящем периоде (m); дисперсии, оцененной на том же векторе (s); доходности обыкновенных акций, рассчитанной как разность натуральных логарифмов котировок (r); среднего значения доходности на скользящем периоде (h) и доходности самого индекса Доу-Джонса, принимаемого за доходность наивной рыночной стратегии (I).

	Это дает возможность в последующих расчетах пользоваться уже готовыми значениями m, s, r, h и I, что значительно ускоряет работу математического пакета Mathcad 15.	

VI.2. Расчет оценок ожидаемой доходности

	В предыдущих главах была рассмотрена методология получения общего решения уравнения Фоккера-Планка. В ходе исследования мы оценили функцию плотности вероятности доходности обыкновенных акций U(x,τ,j) на каждый период τ и для каждой j-ой компании из выборки.

	На данном этапе необходимо сделать оговорку насчет различных методов построения общих решений уравнения Фоккера-Планка. В частности, мы можем строить свои оценки на основе как частных полиномиальных решений уравнения Фоккера-Планка, так и на основе полиномов, полученных в результате проведения операции ортонормировки (которые, как известно, не являются решениями исходной задачи, но зато представляют то же самое линейное пространство, что и «старые» полиномы, а следовательно, легитимно могут быть использованы при построении прогноза). Также мы вольны использовать различные начальные условия, представляющие собой функции плотности вероятности до начала временной эволюции. Речь идет о выборе между функциями плотности вероятности, полученными с помощью решения вариационной задачи для каждого отдельно взятого периода и преобразованной с помощью оператора Перрона-Фробениуса нормальной плотностью.

	В ходе исследования были опытным путем опробованы все различные методы получения оценок доходности, описанные выше. Подробная информация о методологии вычисления ожидаемой доходности, а также о формализованных алгоритмах принятия инвестиционных решений представлена в приложениях.

	Итак, оценки доходности каждой бумаги на каждый период в данном исследовании базируются на максимизации функции плотности вероятности U(x,τ,j) по финансовой переменной x. Иными словами, на каждый период мы находим наиболее вероятное значение доходности по каждой компании из выборки.

	В матрицу δ(τ,j) запишем значения финансовой переменной x, максимизирующие функцию плотности вероятности U(x,τ,j), являющуюся общим решением уравнения Фоккера-Планка. Это и будет вектором (а точнее – матрицей) оценочных значений доходности, на основании которых мы будем стоить торговые правила.

	Обратить особое внимание на этом этапе стоит на выбор инвестиционного горизонта. При составлении общего решения уравнения Фоккера-Планка за него будет отвечать переменная τ под знаком экспоненты (напомним, что данный множитель в составе общего решения мы получили, решая дифференциальное от временной переменной). Все же остальные τ входят в состав итоговых функций плотности вероятности в неявном виде. 

	На данном этапе для простоты ограничимся составлением прогноза на следующий период (на один торговый день вперед). Этого можно достигнуть приняв τ под знаком экспоненты за единицу.

VI.3. Построение и анализ простейшего торгового правила

	Построение торговых стратегий начнем с самого тривиального: логичным кажется купить на следующий период ту бумагу, у которой ожидаемая доходность на данный период максимальна. Для этого в матрицу ατ,j запишем значения ωτ-1,j, являющиеся продуктом максимизации функции плотности вероятности U(x,τ,j). Как мы помним, в простейшем случае мы делаем прогноз на один период вперед, поэтому матрица ωτ-1,j и будет содержать оценки доходности на период τ, рассчитанные по данным предыдущих периодов (на данном этапе очень важно контролировать, чтобы в расчеты не были включены какие-либо данные, связанные с текущим или  следующими периодами, что было бы не честным). Полученную простейшую стратегию назовем стратегией Γ.

На Рис. 2 красным обозначена доходность индекса Доу-Джонса за период 2 июня 2012 г. – 13 мая 2013 г. (всего 239 торговых дней, что практически является длиной американского торгового года, в котором 252 торговых дня).

Как видно из Рис. 2, наивная рыночная стратегия (в данном случае, купить каждую бумагу, входящую в индекс Доу-Джонса и держать ее) приносит прибыль в 19,57% за год. Что же касается простейшей стратегии (синяя линия на Рис. 2), построенной нами в ходе исследования, ее прибыльность составила 105,1% за тот же период.

Хотя это и можно считать весьма неплохим результатом, мы видим, что волатильность построенной стратегии чрезвычайно велика. Тот факт, что инвесторы ценят стабильность не меньше доходности, обуславливает необходимость модификации торгового правила с целью снижения волатильности. 

VI.4. Модификации торгового правила 

	В предыдущем разделе мы убедились в необходимости снижения волатильности полученной простейшей стратегии. Также было бы неплохо добиться при этом повышения доходности.

	Первое, что мы можем сделать, пытаясь снизить волатильность и улучшить нашу стратегию, это начать руководствоваться не «сырой» величиной ожидаемой доходности, а, к примеру, разницей между ожидаемой доходностью и реальной доходностью предыдущего периода по каждой бумаге. В ходе данного исследования экспериментальным путем было выяснено, что в данном контексте подобная практика более выгодна.

Также мы можем попробовать увеличить число бумаг, покупаемых на каждый следующий период и, таким образом, распределить нашу прибыль (и, следовательно, убыток) между несколькими бумагами, что сделает нашу стратегию менее волатильной.

	На Рис.3 стратегия U предусматривает покупку на каждый следующий период трех бумаг с наивысшей ожидаемой доходностью. Как мы видим, с помощью своеобразной диверсификации портфеля нам удалось немного снизить волатильность по сравнению со стратегией Γ. Более того, в стратегии U ясно прослеживается долгосрочный восходящий тренд, несмотря на то, что общая доходность немного снизилась.



	Следующая модификация, которую мы можем применить к нашей стратегии, – это установить отложенный ордер типа stop loss. В частности, мы можем приказать нашему алгоритму торговать только в том случае, если за предыдущие p периодов совокупность его действий привела в положительной доходности. Это особенно актуально в нашем случае, когда мы видим на тренде стратегии U несколько довольно длинных периодов, когда наш алгоритм играл в минус.

	Применим механизм stop loss в стратегии Χ: пусть ее алгоритм будет идентичным стратегии U, но торговля будет осуществляться лишь в том случае, когда за предыдущие два периода наблюдался положительный результат. Исходя из динамики, представленной на Рис. 3, применение механизма отложенного ордера позволило значительно снизить волатильность, а также положительно отразилось на доходности (стратегия Χ).

	Дальнейшие эксперименты с торговыми правилами показали преимущества торговли по одной бумаге с наивысшей ожидаемой доходностью над торговлей несколькими бумагами. Также в ходе исследования были опробованы различные варианты расчета ожидаемой доходности на более далекие инвестиционные горизонты (этого можно добиться, изменяя τ под знаком экспоненты в общем решении), однако, как и следовало ожидать, физикалистский подход, используемый в данной работе, не дает возможности давать оценки на отдаленные периоды в силу диффузии функции плотности вероятности с течением времени и превращения распределения в равномерное.

	Своеобразным венцом данного исследования можно назвать стратегию Ψ, построенную на общем решении уравнения Фоккера-Планка (составленном из частных неортонормированных полиномиальных решений) с использованием преобразованной с помощью оператора Перрона-Фробениуса нормальной плотностью в качестве начального условия. В данной стратегии также был применен механизм stop loss со скользящим периодом в два торговых дня, что позволило значительно снизить волатильность.  

Как видно из Рис. 4, прибыльность стратегии Ψ составила 196,7% менее чем за один год. Ее главным минусом по-прежнему остается довольно высокая волатильность (хотя и гораздо меньше, чем у элементарной стратегии Г). 

















Заключение

	В данном исследовании мы рассмотрели возможность построения эффективной торговой стратегии на основании общих решений дифференциального оператора второго порядка в частных производных – уравнения Фоккера-Планка, задающего временную эволюцию функции плотности вероятности доходности обыкновенных акций компаний, входящих в индекс Доу-Джонса. 

	Мы начали с того, что разобрались в физикалистских истоках уравнения Фоккера-Планка и в том, каким образом данный дифференциальный оператор задает временную эволюцию функции плотности вероятности. Затем мы (уже в контексте анализа финансовых рынков) рассмотрели методологию нахождения частных полиномиальных решений уравнения Фоккера-Планка, общей весовой функции, начального условия в виде функции плотности вероятности до начала временной эволюции, а также полиномиальных весов. Мы далее рассмотрели процедуру ортонормировки методом моментов и методологию получения общих решений уравнения Фоккера-Планка на каждый временной период.

	Основным результатом исследования явилась эффективная торговая стратегия, построенная на базе общих решений уравнения Фоккера-Планка. Даже с учетом сравнительно высокой волатильности, нельзя отрицать значительную доходность данной стратегии – 196,7% менее чем за финансовый год. 

	В заключение хотелось бы отметить некоторые минусы данного подхода к анализу финансовых рынков и обозначить поле дальнейшей деятельности. Как ранее отмечалось в тексте работы, метод разделения переменных при решении уравнения Фоккера-Планка – это стандартный фикизалистский подход, неэффективный для построения долгосрочных оценок. Это происходит в силу действия феномена диффузии – «расплывании» функций плотности вероятности во времени и постепенного их превращения в равномерное распределение.

	В ходе данного исследования мы на практике убедились в достаточной для построения эффективной торговой стратегии реалистичности предпосылок физикалистского подхода в рассмотрении уравнения Фоккера-Планка в одномерном случае. Однако стоит признать, что на сегодняшний день передовыми в финансовой науке являются исследования в области многомерных случаев применения уравнения Фоккера-Планка и соответствующих методов его решения. На это, с учетом опыта, полученного в ходе анализа простых форм данного уравнения, и следует обратить свой взгляд исследователю в ходе дальнейшей работы.



























Список литературы

Будылин А. М.: Вариационное исчисление (Москва, 2001)

Зайцев В. Ф., Полянин А. Д.: Метод разделения переменных в математической физике (Книжный Дом, 2009)

Колмогоров А. Н.: Об аналитических методах в теории вероятностей (Успехи математических наук, в.5, 1932)

Пирумов У. Г.: Численные методы: теория и практика, 5 издание (Юрайт, 2012)

Askey, R.: The 1839 Paper on Permutations: Its Relation to the Rodrigues Formula and Further Developments (American Mathematical Society, 2005)

Batchelor, G. K.: An Introduction to Fluid Dynamics (Cambridge University Press, 1967)

Bichteler, K.: Stochastic Integration with Jump (Cambridge University Press, 2002)

Borda, M.: Fundamentals of Information Theory and Coding (Springer, 2011)

Cohen, I. B.: Newton’s Second Law and the Concept of Force in the Principia (Cambridge, Massachusetts: The MIT Press, 1967)

De la Salle, M.: Operator Space Valued Hankel Matrices (Ecole Normale Superieure, 2003)

Feller, W.: An Introduction to Probability Theory and Its Applications, Volume 2, 3rd edition, (Wiley, 1971) 

Gall, J.: The Systems Bible, 3rd ed. (General Systemantics Press.)

Harper, C.: Introduction to Mathematical Physics (New Jersey, Prentice-Hall, 1976) 

Heaney J., Poitras G.: Distributions for Diffusions Subject to Constant Reflecting Barriers: a Density Decomposition Result (Simon Frazer University, Burnaby B. C., Canada, 2002)

Landshoff, P., Metherell, A., Rees G.: Essential Quantum Physics (Cambridge University Press, 1997)

Mengesha A. T.: Lecture 7 Gram-Schmidt Orthogonalization (PSU, Mathematics Department, 2003)

Meyer, C.: Matrix Analysis and Applied Linear Algebra (SIAM, 2000)

Olver, P.J.: Equivalence, invariants, and symmetry (Oxford University Press, 1995)

Reed, M., Simon, B.: Fourier Analysis, Self-Adjointness, (Methods of modern mathematical physics 2, Academic Press, 1975)

Risken, H.: The Fokker-Planck Equation. Methods of Solution and Applications, 2nd ed. (Springer-Verlag, Berlin, 1989)

Te Sun, H., Kobayashi, K.: Mathematics of Information and Coding (American Mathematical Society, 2002)

Trefethen, L. N., Bau D.: Numerical Linear Algebra (SIAM, 1997) 

Voit, J.: The Statistical Mechanics of Financial Markets, 3rd edition (Springer-Verlag Berlin Heidelberg, 2005)

Финансовый портал www.finance.yahoo.com 

























Приложения

Приложение 1. Файл с базой данных рыночного исследования «Data 2012-2013.xls»

Приложение 2.  Файл с расчетами «Fokker-Planck Solution Technique.xmcd»

Приложение 3.  Файл с расчетами «The Perron-Frobenius Operator.xmcd»

Приложение 4.  Файл с расчетами «Old Polynomials + Normal Distribution.xmcd»

Приложение 5.  Файл с расчетами «Old Polynomials + Variation.xmcd»

Приложение 6.  Файл с расчетами « Orthonormal Polynomials + Normal Distribution.xmcd»

Приложение 7.  Файл с расчетами «Orthonormal Polynomials + Variation.xmcd»





